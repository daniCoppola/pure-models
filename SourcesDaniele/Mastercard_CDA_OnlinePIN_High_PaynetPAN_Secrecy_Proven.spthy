theory Mastercard_CDA_OnlinePIN_High_PaynetPAN begin

// Function signature and definition of the equational theory E

builtins: diffie-hellman, xor
functions: MAC/2, MAC_arpc/2, NEq/2, adec/2, aenc/2, f/2, fst/1,
           h/1, kdf/2, p8/1, pair/2, pk/1, sign/2, snd/1, true/0, verify/3
equations:
    adec(aenc(x.1, pk(x.2)), x.2) = x.1,
    fst(<x.1, x.2>) = x.1,
    snd(<x.1, x.2>) = x.2,
    verify(sign(x.1, x.2), x.1, pk(x.2)) = true



rule (modulo E) Terminal_Bank_Network:
   [ Send( S, R, channelID, msg ) ]
  -->
   [ Recv( S, R, channelID, msg ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Generate_Amount_Low:
   [ ]
  --[ Once( <$amount, 'Amount'> ) ]->
   [ !Value( $amount, 'Low' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Generate_Amount_High:
   [ ]
  --[ Once( <$amount, 'Amount'> ) ]->
   [ !Value( $amount, 'High' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Generate_ATC:
   [ Fr( ~ATC ) ] --> [ !ATC( ~ATC ), Out( ~ATC ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Generate_SDAD_Format_Visa:
   [ ] --> [ !SDADFormat( '05', 'TC' ), !SDADFormat( '95', 'ARQC' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Create_CA:
   [ Fr( ~privkCA ) ]
  --[ Once( $CA ), Role( $CA, 'CA' ) ]->
   [
   !LtkCA( $CA, ~privkCA ),
   !CertCA( $CA,
            <<'01', $CA, pk(~privkCA), $CA>, 
             sign(<'01', $CA, pk(~privkCA), $CA>, ~privkCA)>
   ),
   Out( pk(~privkCA) )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Create_Bank:
   [ Fr( ~privkBank ), !LtkCA( $CA, ~privkCA ) ]
  --[ Once( $Bank ), Role( $Bank, 'Bank' ) ]->
   [
   !LtkBank( $Bank, ~privkBank ),
   !CertBank( $Bank,
              <<'02', $Bank, pk(~privkBank), $CA>, 
               sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)>
   ),
   !IssuingCA( $Bank, $CA ), Out( pk(~privkBank) )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Compromise_CA:
   [ !LtkCA( $CA, ~privkCA ) ]
  --[ Compromise( $CA ) ]->
   [ Out( ~privkCA ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Compromise_Bank:
   [ !LtkBank( $Bank, ~privkBank ) ]
  --[ Compromise( $Bank ) ]->
   [ Out( <$Bank, ~privkBank> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Compromise_Card:
   [ !LtkCard( ~PAN, ~privkCard ) ]
  --[ Compromise( ~PAN ) ]->
   [ Out( <~PAN, ~privkCard> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Compromise_Bank_Card_ShK:
   [ !IssuingBank( ~PAN, $Bank ), !Shk( ~PAN, ~MK ) ]
  --[ Compromise( $Bank ), Compromise( ~PAN ) ]->
   [ Out( ~MK ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Set_PIN:
   [ Fr( ~PIN ), Set_PIN( ~PAN, CVM, $CA, $Bank ) ]
  --[
  NEq( CVM, 'NoPIN' ), SecretPIN( ~PIN ), Honest( $CA ),
  Honest( $Bank ), Honest( ~PAN )
  ]->
   [
   !PIN( ~PAN, ~PIN ), !Entered_PIN( ~PAN, ~PIN ),
   !Entered_PIN( ~PAN, 'WrongPIN' )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Create_Card:
   [
   Fr( ~PAN ), Fr( ~expDate ), Fr( ~MK ),
   !LtkBank( $Bank, ~privkBank ), !CertBank( $Bank, certBank ),
   !IssuingCA( $Bank, $CA ), In( <auth, CVM> )
   ]
  --[
  Role( ~PAN, 'Card' ), SecretPAN( ~PAN ), SecretMK( ~MK ),
  Honest( $CA ), Honest( $Bank ), Honest( ~PAN )
  ]->
   [
   !AIP( ~PAN, <auth, $furtherData> ), !AID( ~PAN, 'Mastercard' ),
   !Shk( ~PAN, ~MK ), !IssuingBank( ~PAN, $Bank ),
   Set_Records( ~PAN, ~expDate, $CA, certBank,
                sign(<'03', ~PAN, ~expDate, auth, $furtherData>, ~privkBank), CVM
   ),
   Set_PIN( ~PAN, CVM, $CA, $Bank )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Set_Records_SDA:
   [
   Set_Records( ~PAN, ~expDate, $CA, certBank, SSAD, CVM ),
   !AIP( ~PAN, <'SDA', furtherData> )
   ]
  -->
   [ !Records( ~PAN, <~PAN, ~expDate, $CA, certBank, SSAD, CVM> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Set_Records_NotSDA:
   [
   Set_Records( ~PAN, ~expDate, $CA, certBank, SSAD, CVM ),
   Fr( ~privkCard ), !AIP( ~PAN, AIP ), !IssuingBank( ~PAN, $Bank ),
   !LtkBank( $Bank, ~privkBank )
   ]
  --[
  NEq( fst(AIP), 'SDA' ), SecretPrivkCard( ~privkCard ),
  Honest( $CA ), Honest( $Bank ), Honest( ~PAN )
  ]->
   [
   Out( pk(~privkCard) ), !LtkCard( ~PAN, ~privkCard ),
   !Records( ~PAN,
             <~PAN, ~expDate, $CA, certBank, 
              <<'04', ~PAN, pk(~privkCard), $Bank, CVM, AIP>, 
               sign(<'04', ~PAN, pk(~privkCard), $Bank, CVM, AIP>, ~privkBank)>, 
              CVM>
   )
   ]

  /*
  rule (modulo AC) Set_Records_NotSDA:
     [
     Set_Records( ~PAN, ~expDate, $CA, certBank, SSAD, CVM ),
     Fr( ~privkCard ), !AIP( ~PAN, AIP ), !IssuingBank( ~PAN, $Bank ),
     !LtkBank( $Bank, ~privkBank )
     ]
    --[
    NEq( z, 'SDA' ), SecretPrivkCard( ~privkCard ), Honest( $CA ),
    Honest( $Bank ), Honest( ~PAN )
    ]->
     [
     Out( pk(~privkCard) ), !LtkCard( ~PAN, ~privkCard ),
     !Records( ~PAN,
               <~PAN, ~expDate, $CA, certBank, 
                <<'04', ~PAN, pk(~privkCard), $Bank, CVM, AIP>, 
                 sign(<'04', ~PAN, pk(~privkCard), $Bank, CVM, AIP>, ~privkBank)>, 
                CVM>
     )
     ]
    variants (modulo AC)
    1. AIP   = AIP.14
       z     = fst(AIP.14)
    
    2. AIP   = <z.17, x.21>
       z     = z.17
  */

rule (modulo E) Terminal_Sends_GPO:
   [ Fr( ~UN ), !Value( $amount, value ) ]
  --[ OneTerminal( ), Role( $Terminal, 'Terminal' ) ]->
   [
   Out( <'GET_PROCESSING_OPTIONS', $amount, 'Switzerland', 'CHF', 
         'YYMMDD', 'Purchase', ~UN>
   ),
   Terminal_Sent_GPO( $Terminal,
                      <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Card_Responds_To_GPO:
   [
   In( <'GET_PROCESSING_OPTIONS', PDOL> ), !AIP( ~PAN, AIP ),
   !AID( ~PAN, 'Mastercard' ), !ATC( ATC )
   ]
  --[ OneCard( ), Once( <~PAN, ATC, 'Card'> ) ]->
   [ Out( <AIP, 'AFL'> ), Card_Responded_To_GPO( ~PAN, PDOL, ATC ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Compromise_Ephemeral_Key_Terminal:
   [ Ephemeral_Key_Terminal( $Terminal, Eph_Pk, ~Eph_Sk ) ]
  --[ Compromise( <$Terminal, Eph_Pk> ) ]->
   [ Out( <Eph_Pk, ~Eph_Sk> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Compromise_Ephemeral_Key_Card:
   [ Ephemeral_Key_Card( ~PAN, Eph_Pk, ~Eph_Sk ) ]
  --[ Compromise( <~PAN, Eph_Pk> ) ]->
   [ Out( <Eph_Pk, ~Eph_Sk> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_Ext_Sends_Hello:
   [
   Terminal_Sent_GPO( $Terminal, PDOL ), In( <AIP, 'AFL'> ),
   Fr( ~Terminal_Eph_Sk )
   ]
  -->
   [
   Terminal_Ext_Sent_Hello( $Terminal, PDOL, AIP,
                            <'g'^~Terminal_Eph_Sk, ~Terminal_Eph_Sk>
   ),
   Out( <'EXT_HELLO', 'g'^~Terminal_Eph_Sk> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Card_Ext_Responds_To_Hello:
   [
   In( <'EXT_HELLO', Terminal_Eph_Pk> ),
   Card_Responded_To_GPO( ~PAN, PDOL, ATC ), Fr( ~Card_Eph_Sk )
   ]
  -->
   [
   Out( <'EXT_HELLO', 'g'^~Card_Eph_Sk, 
         MAC(f(Terminal_Eph_Pk^~Card_Eph_Sk, 'MAC_CARD_TO_READER'),
             <'g'^~Card_Eph_Sk, Terminal_Eph_Pk>)
        >
   ),
   Card_Responded_To_Hello( ~PAN, PDOL, ATC,
                            <'g'^~Card_Eph_Sk, Terminal_Eph_Pk, Terminal_Eph_Pk^~Card_Eph_Sk>
   )
   ]

  /*
  rule (modulo AC) Card_Ext_Responds_To_Hello:
     [
     In( <'EXT_HELLO', Terminal_Eph_Pk> ),
     Card_Responded_To_GPO( ~PAN, PDOL, ATC ), Fr( ~Card_Eph_Sk )
     ]
    -->
     [
     Out( <'EXT_HELLO', 'g'^~Card_Eph_Sk, 
           MAC(f(z, 'MAC_CARD_TO_READER'),
               <'g'^~Card_Eph_Sk, Terminal_Eph_Pk>)
          >
     ),
     Card_Responded_To_Hello( ~PAN, PDOL, ATC,
                              <'g'^~Card_Eph_Sk, Terminal_Eph_Pk, z>
     )
     ]
    variants (modulo AC)
    1. ~Card_Eph_Sk
             = ~Card_Eph_Sk.14
       Terminal_Eph_Pk
             = Terminal_Eph_Pk.18
       z     = Terminal_Eph_Pk.18^~Card_Eph_Sk.14
    
    2. ~Card_Eph_Sk
             = ~Card_Eph_Sk.17
       Terminal_Eph_Pk
             = z.24^inv(~Card_Eph_Sk.17)
       z     = z.24
    
    3. ~Card_Eph_Sk
             = ~Card_Eph_Sk.67
       Terminal_Eph_Pk
             = x.131^x.132
       z     = x.131^(~Card_Eph_Sk.67*x.132)
    
    4. ~Card_Eph_Sk
             = ~Card_Eph_Sk.71
       Terminal_Eph_Pk
             = x.139^inv((~Card_Eph_Sk.71*x.140))
       z     = x.139^inv(x.140)
    
    5. ~Card_Eph_Sk
             = ~Card_Eph_Sk.71
       Terminal_Eph_Pk
             = x.139^(x.140*inv(~Card_Eph_Sk.71))
       z     = x.139^x.140
    
    6. ~Card_Eph_Sk
             = ~Card_Eph_Sk.72
       Terminal_Eph_Pk
             = x.140^(x.141*inv((~Card_Eph_Sk.72*x.142)))
       z     = x.140^(x.141*inv(x.142))
  */

rule (modulo E) Terminal_Ext_Receives_Hello:
   [
   Terminal_Ext_Sent_Hello( $Terminal, PDOL, AIP,
                            <Terminal_Eph_Pk, ~Terminal_Eph_Sk>
   ),
   In( <'EXT_HELLO', Card_Eph_Pk, mac_c> )
   ]
  --[
  Eq( mac_c,
      MAC(f(Card_Eph_Pk^~Terminal_Eph_Sk, 'MAC_CARD_TO_READER'),
          <Card_Eph_Pk, Terminal_Eph_Pk>)
  ),
  Terminal_Ext_Sent_Hello_dbg( $Terminal, PDOL, AIP,
                               <Terminal_Eph_Pk, ~Terminal_Eph_Sk>
  )
  ]->
   [
   Terminal_Ext_Received_Hello( $Terminal, PDOL, AIP,
                                <Card_Eph_Pk, Terminal_Eph_Pk, Card_Eph_Pk^~Terminal_Eph_Sk>
   )
   ]

  /*
  rule (modulo AC) Terminal_Ext_Receives_Hello:
     [
     Terminal_Ext_Sent_Hello( $Terminal, PDOL, AIP,
                              <Terminal_Eph_Pk, ~Terminal_Eph_Sk>
     ),
     In( <'EXT_HELLO', Card_Eph_Pk, mac_c> )
     ]
    --[
    Eq( mac_c,
        MAC(f(z, 'MAC_CARD_TO_READER'), <Card_Eph_Pk, Terminal_Eph_Pk>)
    ),
    Terminal_Ext_Sent_Hello_dbg( $Terminal, PDOL, AIP,
                                 <Terminal_Eph_Pk, ~Terminal_Eph_Sk>
    )
    ]->
     [
     Terminal_Ext_Received_Hello( $Terminal, PDOL, AIP,
                                  <Card_Eph_Pk, Terminal_Eph_Pk, z>
     )
     ]
    variants (modulo AC)
    1. ~Terminal_Eph_Sk
             = ~Terminal_Eph_Sk.13
       Card_Eph_Pk
             = Card_Eph_Pk.15
       z     = Card_Eph_Pk.15^~Terminal_Eph_Sk.13
    
    2. ~Terminal_Eph_Sk
             = ~Terminal_Eph_Sk.18
       Card_Eph_Pk
             = z.25^inv(~Terminal_Eph_Sk.18)
       z     = z.25
    
    3. ~Terminal_Eph_Sk
             = ~Terminal_Eph_Sk.21
       Card_Eph_Pk
             = x.38^x.39
       z     = x.38^(~Terminal_Eph_Sk.21*x.39)
    
    4. ~Terminal_Eph_Sk
             = ~Terminal_Eph_Sk.23
       Card_Eph_Pk
             = x.42^inv((~Terminal_Eph_Sk.23*x.43))
       z     = x.42^inv(x.43)
    
    5. ~Terminal_Eph_Sk
             = ~Terminal_Eph_Sk.23
       Card_Eph_Pk
             = x.42^(x.43*inv(~Terminal_Eph_Sk.23))
       z     = x.42^x.43
    
    6. ~Terminal_Eph_Sk
             = ~Terminal_Eph_Sk.24
       Card_Eph_Pk
             = x.43^(x.44*inv((~Terminal_Eph_Sk.24*x.45)))
       z     = x.43^(x.44*inv(x.45))
  */

rule (modulo E) Terminal_Sends_ReadRecord:
   [ Terminal_Ext_Received_Hello( $Terminal, PDOL, AIP, DH ) ]
  -->
   [
   Out( <'READ_RECORD', 'AFL'> ),
   Terminal_Sent_ReadRecord( $Terminal, PDOL, AIP, DH )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Card_Responds_To_ReadRecord_NotDDA:
   [
   Card_Responded_To_Hello( ~PAN, PDOL, ATC, DH ), !AIP( ~PAN, AIP ),
   !Records( ~PAN, records ), In( <'READ_RECORD', 'AFL'> )
   ]
  --[ NEq( fst(AIP), 'DDA' ) ]->
   [ Out( records ), Card_Ready_For_Cryptogram( ~PAN, PDOL, ATC, DH )
   ]

  /*
  rule (modulo AC) Card_Responds_To_ReadRecord_NotDDA:
     [
     Card_Responded_To_Hello( ~PAN, PDOL, ATC, DH ), !AIP( ~PAN, AIP ),
     !Records( ~PAN, records ), In( <'READ_RECORD', 'AFL'> )
     ]
    --[ NEq( z, 'DDA' ) ]->
     [ Out( records ), Card_Ready_For_Cryptogram( ~PAN, PDOL, ATC, DH )
     ]
    variants (modulo AC)
    1. AIP   = AIP.11
       z     = fst(AIP.11)
    
    2. AIP   = <z.16, x.22>
       z     = z.16
  */

rule (modulo E) Terminal_Receives_Records_CDA:
   [
   Terminal_Sent_ReadRecord( $Terminal, PDOL, <'CDA', furtherData>, DH
   ),
   In( <~PAN, expDate, $CA, <<'02', $Bank, pubkBank, $CA>, sign2>, 
        <<'04', ~PAN, pubkCard, $Bank, CVM, 'CDA', furtherData>, sign3>, 
        CVM>
   ),
   !IssuingCA( $Bank, $CA ),
   !CertCA( $CA, <<'01', $CA, pubkCA, $CA>, sign1> )
   ]
  --[
  Eq( verify(sign1, <'01', $CA, pubkCA, $CA>, pubkCA), true ),
  Eq( verify(sign2, <'02', $Bank, pubkBank, $CA>, pubkCA), true ),
  Eq( verify(sign3,
             <'04', ~PAN, pubkCard, $Bank, CVM, 'CDA', furtherData>, pubkBank),
      true
  )
  ]->
   [
   Terminal_Ready_For_CVM( $Terminal, ~PAN, $Bank, $CA, PDOL,
                           <'CDA', furtherData>, DH, pubkBank, pubkCard, CVM
   )
   ]

  /*
  rule (modulo AC) Terminal_Receives_Records_CDA:
     [
     Terminal_Sent_ReadRecord( $Terminal, PDOL, <'CDA', furtherData>, DH
     ),
     In( <~PAN, expDate, $CA, <<'02', $Bank, pubkBank, $CA>, sign2>, 
          <<'04', ~PAN, pubkCard, $Bank, CVM, 'CDA', furtherData>, sign3>, 
          CVM>
     ),
     !IssuingCA( $Bank, $CA ),
     !CertCA( $CA, <<'01', $CA, pubkCA, $CA>, sign1> )
     ]
    --[ Eq( z, true ), Eq( z.1, true ), Eq( z.2, true ) ]->
     [
     Terminal_Ready_For_CVM( $Terminal, ~PAN, $Bank, $CA, PDOL,
                             <'CDA', furtherData>, DH, pubkBank, pubkCard, CVM
     )
     ]
    variants (modulo AC)
    1. $Bank = $Bank.38
       $CA   = $CA.39
       ~PAN  = ~PAN.41
       CVM   = CVM.42
       furtherData
             = furtherData.46
       pubkBank
             = pubkBank.47
       pubkCA
             = pubkCA.48
       pubkCard
             = pubkCard.49
       sign1 = sign1.50
       sign2 = sign2.51
       sign3 = sign3.52
       z     = verify(sign1.50, <'01', $CA.39, pubkCA.48, $CA.39>,
                      pubkCA.48)
       z.1   = verify(sign2.51, <'02', $Bank.38, pubkBank.47, $CA.39>,
                      pubkCA.48)
       z.2   = verify(sign3.52,
                      <'04', ~PAN.41, pubkCard.49, $Bank.38, CVM.42, 'CDA', 
                       furtherData.46>,
                      pubkBank.47)
    
    2. $Bank = $Bank.99
       $CA   = $CA.100
       ~PAN  = ~PAN.102
       CVM   = CVM.103
       furtherData
             = furtherData.107
       pubkBank
             = pubkBank.108
       pubkCA
             = pk(x.196)
       pubkCard
             = pubkCard.110
       sign1 = sign(<'01', $CA.100, pk(x.196), $CA.100>, x.196)
       sign2 = sign2.112
       sign3 = sign3.113
       z     = true
       z.1   = verify(sign2.112, <'02', $Bank.99, pubkBank.108, $CA.100>,
                      pk(x.196))
       z.2   = verify(sign3.113,
                      <'04', ~PAN.102, pubkCard.110, $Bank.99, CVM.103, 'CDA', 
                       furtherData.107>,
                      pubkBank.108)
    
    3. $Bank = $Bank.99
       $CA   = $CA.100
       ~PAN  = ~PAN.102
       CVM   = CVM.103
       furtherData
             = furtherData.107
       pubkBank
             = pk(x.196)
       pubkCA
             = pubkCA.109
       pubkCard
             = pubkCard.110
       sign1 = sign1.111
       sign2 = sign2.112
       sign3 = sign(<'04', ~PAN.102, pubkCard.110, $Bank.99, CVM.103, 
                     'CDA', furtherData.107>,
                    x.196)
       z     = verify(sign1.111, <'01', $CA.100, pubkCA.109, $CA.100>,
                      pubkCA.109)
       z.1   = verify(sign2.112, <'02', $Bank.99, pk(x.196), $CA.100>,
                      pubkCA.109)
       z.2   = true
    
    4. $Bank = $Bank.100
       $CA   = $CA.101
       ~PAN  = ~PAN.103
       CVM   = CVM.104
       furtherData
             = furtherData.108
       pubkBank
             = pubkBank.109
       pubkCA
             = pk(x.198)
       pubkCard
             = pubkCard.111
       sign1 = sign1.112
       sign2 = sign(<'02', $Bank.100, pubkBank.109, $CA.101>, x.198)
       sign3 = sign3.114
       z     = verify(sign1.112, <'01', $CA.101, pk(x.198), $CA.101>,
                      pk(x.198))
       z.1   = true
       z.2   = verify(sign3.114,
                      <'04', ~PAN.103, pubkCard.111, $Bank.100, CVM.104, 'CDA', 
                       furtherData.108>,
                      pubkBank.109)
    
    5. $Bank = $Bank.100
       $CA   = $CA.101
       ~PAN  = ~PAN.103
       CVM   = CVM.104
       furtherData
             = furtherData.108
       pubkBank
             = pubkBank.109
       pubkCA
             = pk(x.198)
       pubkCard
             = pubkCard.111
       sign1 = sign(<'01', $CA.101, pk(x.198), $CA.101>, x.198)
       sign2 = sign(<'02', $Bank.100, pubkBank.109, $CA.101>, x.198)
       sign3 = sign3.114
       z     = true
       z.1   = true
       z.2   = verify(sign3.114,
                      <'04', ~PAN.103, pubkCard.111, $Bank.100, CVM.104, 'CDA', 
                       furtherData.108>,
                      pubkBank.109)
    
    6. $Bank = $Bank.100
       $CA   = $CA.101
       ~PAN  = ~PAN.103
       CVM   = CVM.104
       furtherData
             = furtherData.108
       pubkBank
             = pk(x.197)
       pubkCA
             = pk(x.198)
       pubkCard
             = pubkCard.111
       sign1 = sign1.112
       sign2 = sign(<'02', $Bank.100, pk(x.197), $CA.101>, x.198)
       sign3 = sign(<'04', ~PAN.103, pubkCard.111, $Bank.100, CVM.104, 
                     'CDA', furtherData.108>,
                    x.197)
       z     = verify(sign1.112, <'01', $CA.101, pk(x.198), $CA.101>,
                      pk(x.198))
       z.1   = true
       z.2   = true
    
    7. $Bank = $Bank.100
       $CA   = $CA.101
       ~PAN  = ~PAN.103
       CVM   = CVM.104
       furtherData
             = furtherData.108
       pubkBank
             = pk(x.197)
       pubkCA
             = pk(x.198)
       pubkCard
             = pubkCard.111
       sign1 = sign(<'01', $CA.101, pk(x.198), $CA.101>, x.198)
       sign2 = sign2.113
       sign3 = sign(<'04', ~PAN.103, pubkCard.111, $Bank.100, CVM.104, 
                     'CDA', furtherData.108>,
                    x.197)
       z     = true
       z.1   = verify(sign2.113, <'02', $Bank.100, pk(x.197), $CA.101>,
                      pk(x.198))
       z.2   = true
    
    8. $Bank = $Bank.100
       $CA   = $CA.101
       ~PAN  = ~PAN.103
       CVM   = CVM.104
       furtherData
             = furtherData.108
       pubkBank
             = pk(x.197)
       pubkCA
             = pk(x.198)
       pubkCard
             = pubkCard.111
       sign1 = sign(<'01', $CA.101, pk(x.198), $CA.101>, x.198)
       sign2 = sign(<'02', $Bank.100, pk(x.197), $CA.101>, x.198)
       sign3 = sign(<'04', ~PAN.103, pubkCard.111, $Bank.100, CVM.104, 
                     'CDA', furtherData.108>,
                    x.197)
       z     = true
       z.1   = true
       z.2   = true
  */

rule (modulo E) Terminal_Processes_CVM_NoPIN:
   [
   Terminal_Ready_For_CVM( $Terminal, ~PAN, $Bank, $CA,
                           <$amount, country, currency, date, type, ~UN>, AIP, DH, pubkBank,
                           pubkCard, CVM
   ),
   !Value( $amount, 'Low' )
   ]
  -->
   [
   Terminal_Ready_For_Cryptogram( $Terminal, ~PAN, $Bank, $CA,
                                  <$amount, country, currency, date, type, ~UN>, AIP, DH, pubkBank,
                                  pubkCard, 'NoPIN', 'Null', CVM
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_Processes_CVM_OnlinePIN:
   [
   Terminal_Ready_For_CVM( $Terminal, ~PAN, $Bank, $CA,
                           <$amount, country, currency, date, type, ~UN>, AIP, DH, pubkBank,
                           pubkCard, 'OnlinePIN'
   ),
   !Entered_PIN( ~PAN, PIN ), !Value( $amount, 'High' )
   ]
  -->
   [
   Terminal_Ready_For_Cryptogram( $Terminal, ~PAN, $Bank, $CA,
                                  <$amount, country, currency, date, type, ~UN>, AIP, DH, pubkBank,
                                  pubkCard, 'OnlinePIN', aenc(PIN, pubkBank), 'OnlinePIN'
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_Processes_CVM_ODCVM:
   [
   Terminal_Ready_For_CVM( $Terminal, ~PAN, $Bank, $CA,
                           <$amount, country, currency, date, type, ~UN>,
                           <auth, 'ODCVM', furtherData2>, DH, pubkBank, pubkCard, CVM
   ),
   !Value( $amount, 'High' )
   ]
  -->
   [
   Terminal_Ready_For_Cryptogram( $Terminal, ~PAN, $Bank, $CA,
                                  <$amount, country, currency, date, type, ~UN>,
                                  <auth, 'ODCVM', furtherData2>, DH, pubkBank, pubkCard, 'ODCVM',
                                  'Null', CVM
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_Sends_GenerateAC_CDA:
   [
   Terminal_Ready_For_Cryptogram( $Terminal, ~PAN, $Bank, $CA, PDOL,
                                  <'CDA', furtherData>, DH, pubkBank, pubkCard, CVM, encPIN,
                                  supportedCVM
   ),
   In( acType )
   ]
  -->
   [
   Out( <'GENERATE_AC', acType, 'CDA', 'TVR', CVM, 'HHMMSS'> ),
   Terminal_Sent_GenerateAC_CDA( $Terminal, ~PAN, $Bank, $CA,
                                 <PDOL, 'TVR', CVM, 'HHMMSS'>, <'CDA', furtherData>, DH, pubkBank,
                                 pubkCard, CVM, encPIN, acType, supportedCVM
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Card_Responds_To_GenerateAC_CDA:
   [
   Card_Ready_For_Cryptogram( ~PAN,
                              <amount, country, currency, date, type, UN>, ATC,
                              <Card_Eph_Pk, Terminal_Eph_Pk, Secret>
   ),
   !LtkCard( ~PAN, ~privkCard ), !AIP( ~PAN, <'CDA', furtherData> ),
   !Shk( ~PAN, ~MK ), !IssuingBank( ~PAN, $Bank ), Fr( ~nc ),
   In( <'GENERATE_AC', CID, 'CDA', 'TVR', CVM, 'HHMMSS'> )
   ]
  --[
  Running( ~PAN, 'Terminal',
           <'Card', 'Terminal', ~PAN, <'CDA', furtherData>, CVM, 
            <<amount, country, currency, date, type, UN>, 'TVR', CVM, 'HHMMSS'
            >, 
            ATC, <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, 
            MAC(f(~MK, ATC),
                <
                 <<amount, country, currency, date, type, UN>, 'TVR', CVM, 'HHMMSS'
                 >, 
                 <'CDA', furtherData>, ATC, 'IAD', CID>), 
            <'IAD', CID>, 'Mastercard'>
  ),
  Running( ~PAN, $Bank,
           <'Card', 'Bank', ~PAN, <'CDA', furtherData>, CVM, 
            <<amount, country, currency, date, type, UN>, 'TVR', CVM, 'HHMMSS'
            >, 
            ATC, <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, 
            MAC(f(~MK, ATC),
                <
                 <<amount, country, currency, date, type, UN>, 'TVR', CVM, 'HHMMSS'
                 >, 
                 <'CDA', furtherData>, ATC, 'IAD', CID>), 
            <'IAD', CID>, 'Mastercard'>
  )
  ]->
   [
   Out( <CID, ATC, 
         MAC(f(~MK, ATC),
             <
              <<amount, country, currency, date, type, UN>, 'TVR', CVM, 'HHMMSS'
              >, 
              <'CDA', furtherData>, ATC, 'IAD', CID>), 
         <~nc, 
          sign(<'05', ~nc, CID, 
                MAC(f(~MK, ATC),
                    <
                     <<amount, country, currency, date, type, UN>, 'TVR', CVM, 'HHMMSS'
                     >, 
                     <'CDA', furtherData>, ATC, 'IAD', CID>), 
                h(<
                   <<amount, country, currency, date, type, UN>, 'TVR', CVM, 'HHMMSS'
                   >, 
                   CID, ATC, 
                   MAC(f(~MK, ATC),
                       <
                        <<amount, country, currency, date, type, UN>, 'TVR', CVM, 'HHMMSS'
                        >, 
                        <'CDA', furtherData>, ATC, 'IAD', CID>), 
                   <'IAD', CID>, Card_Eph_Pk, Terminal_Eph_Pk>), 
                UN>,
               ~privkCard)
         >, 
         'IAD', CID>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_Receives_AC_CDA:
   [
   Terminal_Sent_GenerateAC_CDA( $Terminal, ~PAN, $Bank, $CA,
                                 <<$amount, country, currency, date, type, ~UN>, CDOL1>, AIP,
                                 <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, pubkBank, pubkCard, CVM,
                                 encPIN, acType, supportedCVM
   ),
   In( <CID, ATC, AC, <nc, SDAD>, IAD> ), Fr( ~channelID )
   ]
  --[
  Compatible_CID_acType( CID, acType ),
  Compatible_CID_CVM( CID, CVM ),
  Eq( verify(SDAD,
             <'05', nc, CID, AC, 
              h(<<<$amount, country, currency, date, type, ~UN>, CDOL1>, CID, 
                 ATC, AC, IAD, Card_Eph_Pk, Terminal_Eph_Pk>), 
              ~UN>,
             pubkCard),
      true
  ),
  Running( $Terminal, $Bank,
           <'Terminal', 'Bank', ~PAN, AIP, CVM, 
            <<$amount, country, currency, date, type, ~UN>, CDOL1>, ATC, 
            <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, AC, IAD, 'Mastercard'>
  )
  ]->
   [
   Terminal_Received_AC( $Terminal, $Bank, $CA, 'Null', CID,
                         <~PAN, AIP, CVM, 
                          <<$amount, country, currency, date, type, ~UN>, CDOL1>, ATC, 
                          <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, AC, IAD, 'Mastercard'>,
                         supportedCVM, ~channelID
   ),
   Send( $Terminal, $Bank, <~channelID, '1'>,
         <
          <~PAN, AIP, CVM, 
           <<$amount, country, currency, date, type, ~UN>, CDOL1>, ATC, 
           <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, AC, IAD, 'Mastercard'>, 
          encPIN>
   )
   ]

  /*
  rule (modulo AC) Terminal_Receives_AC_CDA:
     [
     Terminal_Sent_GenerateAC_CDA( $Terminal, ~PAN, $Bank, $CA,
                                   <<$amount, country, currency, date, type, ~UN>, CDOL1>, AIP,
                                   <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, pubkBank, pubkCard, CVM,
                                   encPIN, acType, supportedCVM
     ),
     In( <CID, ATC, AC, <nc, SDAD>, IAD> ), Fr( ~channelID )
     ]
    --[
    Compatible_CID_acType( CID, acType ),
    Compatible_CID_CVM( CID, CVM ), Eq( z, true ),
    Running( $Terminal, $Bank,
             <'Terminal', 'Bank', ~PAN, AIP, CVM, 
              <<$amount, country, currency, date, type, ~UN>, CDOL1>, ATC, 
              <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, AC, IAD, 'Mastercard'>
    )
    ]->
     [
     Terminal_Received_AC( $Terminal, $Bank, $CA, 'Null', CID,
                           <~PAN, AIP, CVM, 
                            <<$amount, country, currency, date, type, ~UN>, CDOL1>, ATC, 
                            <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, AC, IAD, 'Mastercard'>,
                           supportedCVM, ~channelID
     ),
     Send( $Terminal, $Bank, <~channelID, '1'>,
           <
            <~PAN, AIP, CVM, 
             <<$amount, country, currency, date, type, ~UN>, CDOL1>, ATC, 
             <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, AC, IAD, 'Mastercard'>, 
            encPIN>
     )
     ]
    variants (modulo AC)
    1. $amount
             = $amount.58
       ~UN   = ~UN.60
       AC    = AC.62
       ATC   = ATC.64
       CDOL1 = CDOL1.65
       CID   = CID.66
       Card_Eph_Pk
             = Card_Eph_Pk.68
       IAD   = IAD.69
       SDAD  = SDAD.70
       Terminal_Eph_Pk
             = Terminal_Eph_Pk.72
       country
             = country.74
       currency
             = currency.75
       date  = date.76
       nc    = nc.78
       pubkCard
             = pubkCard.80
       type  = type.82
       z     = verify(SDAD.70,
                      <'05', nc.78, CID.66, AC.62, 
                       h(<
                          <<$amount.58, country.74, currency.75, date.76, type.82, ~UN.60>, 
                           CDOL1.65>, 
                          CID.66, ATC.64, AC.62, IAD.69, Card_Eph_Pk.68, Terminal_Eph_Pk.72
                         >), 
                       ~UN.60>,
                      pubkCard.80)
    
    2. $amount
             = $amount.176
       ~UN   = ~UN.178
       AC    = AC.180
       ATC   = ATC.182
       CDOL1 = CDOL1.183
       CID   = CID.184
       Card_Eph_Pk
             = Card_Eph_Pk.186
       IAD   = IAD.187
       SDAD  = sign(<'05', nc.196, CID.184, AC.180, 
                     h(<
                        <
                         <$amount.176, country.192, currency.193, date.194, type.200, 
                          ~UN.178>, 
                         CDOL1.183>, 
                        CID.184, ATC.182, AC.180, IAD.187, Card_Eph_Pk.186, 
                        Terminal_Eph_Pk.190>), 
                     ~UN.178>,
                    x.347)
       Terminal_Eph_Pk
             = Terminal_Eph_Pk.190
       country
             = country.192
       currency
             = currency.193
       date  = date.194
       nc    = nc.196
       pubkCard
             = pk(x.347)
       type  = type.200
       z     = true
  */

rule (modulo E) Terminal_Commits_TC:
   [
   Terminal_Received_AC( $Terminal, $Bank, $CA, nc, 'TC',
                         <~PAN, <'CDA', furtherData>, CVM, 
                          <<$amount, country, currency, date, type, ~UN>, CDOL1>, ATC, 
                          <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, AC, IAD, 'Mastercard'>,
                         'OnlinePIN', ~channelID
   ),
   !Value( $amount, 'High' )
   ]
  --[
  Ignore( ),
  TerminalAccepts( <~PAN, <'CDA', furtherData>, CVM, 
                    <<$amount, country, currency, date, type, ~UN>, CDOL1>, ATC, 
                    <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, AC, IAD, 'Mastercard'>
  ),
  Commit( 'Terminal', ~PAN,
          <'Card', 'Terminal', ~PAN, <'CDA', furtherData>, CVM, 
           <<$amount, country, currency, date, type, ~UN>, CDOL1>, ATC, 
           <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, AC, IAD, 'Mastercard'>
  ),
  Secret_Sigma( Secret ), Honest( $CA ), Honest( $Bank ),
  Honest( $Terminal ), Honest( ~PAN ), Honest( <~PAN, Card_Eph_Pk> ),
  Honest( <$Terminal, Terminal_Eph_Pk> )
  ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_Commits_ARQC:
   [
   Terminal_Received_AC( $Terminal, $Bank, $CA, nc, 'ARQC',
                         <~PAN, <'CDA', furtherData>, CVM, 
                          <<$amount, country, currency, date, type, ~UN>, CDOL1>, ATC, 
                          <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, AC, IAD, 'Mastercard'>,
                         'OnlinePIN', ~channelID
   ),
   !Value( $amount, 'High' ),
   Recv( $Bank, $Terminal, <~channelID, '2'>, <'ARC', ARPC> )
   ]
  --[
  TerminalAccepts( <~PAN, <'CDA', furtherData>, CVM, 
                    <<$amount, country, currency, date, type, ~UN>, CDOL1>, ATC, 
                    <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, AC, IAD, 'Mastercard'>
  ),
  Commit( 'Terminal', ~PAN,
          <'Card', 'Terminal', ~PAN, <'CDA', furtherData>, CVM, 
           <<$amount, country, currency, date, type, ~UN>, CDOL1>, ATC, 
           <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, AC, IAD, 'Mastercard'>
  ),
  Commit( $Terminal, $Bank,
          <'Bank', 'Terminal', ~PAN, <'CDA', furtherData>, CVM, 
           <<$amount, country, currency, date, type, ~UN>, CDOL1>, ATC, 
           <Card_Eph_Pk, Terminal_Eph_Pk, Secret>, AC, IAD, 'Mastercard'>
  ),
  Secret_Sigma( Secret ), Honest( $CA ), Honest( $Bank ),
  Honest( $Terminal ), Honest( ~PAN ), Honest( Card_Eph_Pk ),
  Honest( Terminal_Eph_Pk )
  ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) Bank_Receives_AC:
   [
   Recv( $Terminal, $Bank, <channelID, '1'>,
         <
          <~PAN, AIP, CVM, X, ATC, DH, MAC(f(~MK, ATC), <X, AIP, ATC, IAD>), 
           IAD, AID>, 
          encPIN>
   ),
   !Shk( ~PAN, ~MK ), !IssuingBank( ~PAN, $Bank )
   ]
  --[ Once( <~PAN, ATC, 'Bank'> ) ]->
   [
   Bank_Checked_AC( $Bank, $Terminal,
                    <~PAN, AIP, CVM, X, ATC, DH, MAC(f(~MK, ATC), <X, AIP, ATC, IAD>), 
                     IAD, AID>,
                    encPIN, channelID,
                    MAC_arpc(f(~MK, ATC),
                             (MAC(f(~MK, ATC), <X, AIP, ATC, IAD>)⊕p8('ARC')))
   )
   ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

rule (modulo E) Bank_Receives_AC_Failed:
   [
   Recv( $Terminal, $Bank, <channelID, '1'>,
         <<~PAN, AIP, CVM, X, ATC, DH, AC, IAD, AID>, encPIN>
   ),
   !Shk( ~PAN, ~MK )
   ]
  --[
  NEq( MAC(f(~MK, ATC), <X, AIP, ATC, IAD>), AC ),
  BankDeclines( <~PAN, AIP, CVM, X, ATC, DH, AC, IAD, AID> )
  ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) Bank_Processes_CVM_NotOnlinePIN:
   [
   Bank_Checked_AC( $Bank, $Terminal,
                    <~PAN, AIP, CVM, X, ATC, DH, AC, IAD, AID>, 'Null', channelID, ARPC
   )
   ]
  --[
  NEq( CVM, 'OnlinePIN' ),
  Running( $Bank, $Terminal,
           <'Bank', 'Terminal', ~PAN, AIP, CVM, X, ATC, DH, AC, IAD, AID>
  )
  ]->
   [
   Bank_Commits( $Bank, $Terminal,
                 <~PAN, AIP, CVM, X, ATC, DH, AC, IAD, AID>, channelID, ARPC
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Bank_Commits:
   [
   Bank_Commits( $Bank, $Terminal,
                 <~PAN, <'CDA', furtherData>, CVM, 
                  <<amount, country, currency, date, type, UN>, CDOL1>, ATC, DH, AC, 
                  IAD, AID>,
                 channelID, ARPC
   ),
   !Value( amount, 'High' ), !AID( ~PAN, 'Mastercard' ),
   !IssuingCA( $Bank, $CA )
   ]
  --[
  Commit( $Bank, ~PAN,
          <'Card', 'Bank', ~PAN, <'CDA', furtherData>, CVM, 
           <<amount, country, currency, date, type, UN>, CDOL1>, ATC, DH, AC, 
           IAD, AID>
  ),
  Commit( $Bank, $Terminal,
          <'Terminal', 'Bank', ~PAN, <'CDA', furtherData>, CVM, 
           <<amount, country, currency, date, type, UN>, CDOL1>, ATC, DH, AC, 
           IAD, AID>
  ),
  Honest( $CA ), Honest( $Bank ), Honest( $Terminal ), Honest( ~PAN )
  ]->
   [ Send( $Bank, $Terminal, <channelID, '2'>, <'ARC', ARPC> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Bank_Processes_CVM_OnlinePIN:
   [
   Bank_Checked_AC( $Bank, $Terminal,
                    <~PAN, AIP, 'OnlinePIN', X, ATC, DH, AC, IAD, AID>,
                    aenc(PIN, pk(~privkBank)), channelID, ARPC
   ),
   !LtkBank( $Bank, ~privkBank ), !PIN( ~PAN, PIN )
   ]
  --[
  Running( $Bank, $Terminal,
           <'Bank', 'Terminal', ~PAN, AIP, 'OnlinePIN', X, ATC, DH, AC, IAD, 
            AID>
  )
  ]->
   [
   Bank_Commits( $Bank, $Terminal,
                 <~PAN, AIP, 'OnlinePIN', X, ATC, DH, AC, IAD, AID>, channelID, ARPC
   )
   ]

  /* has exactly the trivial AC variant */

restriction equal:
  "∀ a b #i. (Eq( a, b ) @ #i) ⇒ (a = b)"
  // safety formula

restriction not_equal:
  "∀ a #i. (NEq( a, a ) @ #i) ⇒ (⊥)"
  // safety formula

restriction once:
  "∀ a #i #j. ((Once( a ) @ #i) ∧ (Once( a ) @ #j)) ⇒ (#i = #j)"
  // safety formula

restriction unique_role:
  "∀ A r1 r2 #i #j.
    ((Role( A, r1 ) @ #i) ∧ (Role( A, r2 ) @ #j)) ⇒ (r1 = r2)"
  // safety formula

restriction compatibility:
  "(∀ #i. (Compatible_CID_CVM( 'TC', 'OnlinePIN' ) @ #i) ⇒ (⊥)) ∧
   (∀ #i. (Compatible_CID_acType( 'TC', 'ARQC' ) @ #i) ⇒ (⊥))"
  // safety formula

lemma executable:
  exists-trace
  "∃ Bank PAN t #i #j #k #l.
    (((((((((#i < #j) ∧
            (Running( PAN, 'Terminal', <'Card', 'Terminal', t> ) @ #i)) ∧
           (Commit( 'Terminal', PAN, <'Card', 'Terminal', t> ) @ #j)) ∧
          (#k < #l)) ∧
         (Running( PAN, Bank, <'Card', 'Bank', t> ) @ #k)) ∧
        (Commit( Bank, PAN, <'Card', 'Bank', t> ) @ #l)) ∧
       (∀ #a #b. ((OneCard( ) @ #a) ∧ (OneCard( ) @ #b)) ⇒ (#a = #b))) ∧
      (∀ #a #b.
        ((OneTerminal( ) @ #a) ∧ (OneTerminal( ) @ #b)) ⇒ (#a = #b))) ∧
     (∀ A B r #a #b.
       ((Role( A, r ) @ #a) ∧ (Role( B, r ) @ #b)) ⇒ (A = B))) ∧
    (¬(∃ A #a. Compromise( A ) @ #a))"
/*
guarded formula characterizing all satisfying traces:
"∃ Bank PAN t #i #j #k #l.
  (Running( PAN, 'Terminal', <'Card', 'Terminal', t> ) @ #i) ∧
  (Commit( 'Terminal', PAN, <'Card', 'Terminal', t> ) @ #j) ∧
  (Running( PAN, Bank, <'Card', 'Bank', t> ) @ #k) ∧
  (Commit( Bank, PAN, <'Card', 'Bank', t> ) @ #l)
 ∧
  (#i < #j) ∧
  (#k < #l) ∧
  (∀ #a #b. (OneCard( ) @ #a) ∧ (OneCard( ) @ #b) ⇒ #a = #b) ∧
  (∀ #a #b.
    (OneTerminal( ) @ #a) ∧ (OneTerminal( ) @ #b) ⇒ #a = #b) ∧
  (∀ A B r #a #b.
    (Role( A, r ) @ #a) ∧ (Role( B, r ) @ #b) ⇒ A = B) ∧
  (∀ A #a. (Compromise( A ) @ #a) ⇒ ⊥)"
*/
by sorry

lemma bank_accepts:
  all-traces
  "∀ t #i.
    (TerminalAccepts( t ) @ #i) ⇒
    ((¬(∃ #j. BankDeclines( t ) @ #j)) ∨
     (∃ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ t #i.
  (TerminalAccepts( t ) @ #i)
 ∧
  (∃ #j. (BankDeclines( t ) @ #j)) ∧
  (∀ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k) ⇒ ⊥)"
*/
by sorry

lemma auth_to_terminal_minimal:
  all-traces
  "∀ T P r t #i.
    ((∀ #a #b. ((OneCard( ) @ #a) ∧ (OneCard( ) @ #b)) ⇒ (#a = #b)) ∧
     (Commit( T, P, <r, 'Terminal', t> ) @ #i)) ⇒
    ((∃ #j. Running( P, T, <r, 'Terminal', t> ) @ #j) ∨
     (∃ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ T P r t #i.
  (Commit( T, P, <r, 'Terminal', t> ) @ #i)
 ∧
  (∀ #a #b. (OneCard( ) @ #a) ∧ (OneCard( ) @ #b) ⇒ #a = #b) ∧
  (∀ #j. (Running( P, T, <r, 'Terminal', t> ) @ #j) ⇒ ⊥) ∧
  (∀ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k) ⇒ ⊥)"
*/
by sorry

lemma auth_to_terminal:
  all-traces
  "∀ T P r t #i.
    (Commit( T, P, <r, 'Terminal', t> ) @ #i) ⇒
    (((∃ #j. (Running( P, T, <r, 'Terminal', t> ) @ #j) ∧ (#j < #i)) ∧
      (¬(∃ T2 P2 #i2.
          (Commit( T2, P2, <r, 'Terminal', t> ) @ #i2) ∧ (¬(#i2 = #i))))) ∨
     (∃ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ T P r t #i.
  (Commit( T, P, <r, 'Terminal', t> ) @ #i)
 ∧
  (((∀ #j. (Running( P, T, <r, 'Terminal', t> ) @ #j) ⇒ ¬(#j < #i)) ∨
    (∃ T2 P2 #i2.
      (Commit( T2, P2, <r, 'Terminal', t> ) @ #i2) ∧ ¬(#i2 = #i)))) ∧
  (∀ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k) ⇒ ⊥)"
*/
by sorry

lemma auth_to_bank_minimal:
  all-traces
  "∀ B P r t #i.
    ((∀ #a #b. ((OneCard( ) @ #a) ∧ (OneCard( ) @ #b)) ⇒ (#a = #b)) ∧
     (Commit( B, P, <r, 'Bank', t> ) @ #i)) ⇒
    ((∃ #j. Running( P, B, <r, 'Bank', t> ) @ #j) ∨
     (∃ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ B P r t #i.
  (Commit( B, P, <r, 'Bank', t> ) @ #i)
 ∧
  (∀ #a #b. (OneCard( ) @ #a) ∧ (OneCard( ) @ #b) ⇒ #a = #b) ∧
  (∀ #j. (Running( P, B, <r, 'Bank', t> ) @ #j) ⇒ ⊥) ∧
  (∀ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k) ⇒ ⊥)"
*/
by sorry

lemma auth_to_bank:
  all-traces
  "∀ B P r t #i.
    (Commit( B, P, <r, 'Bank', t> ) @ #i) ⇒
    (((∃ #j. (Running( P, B, <r, 'Bank', t> ) @ #j) ∧ (#j < #i)) ∧
      (¬(∃ B2 P2 #i2.
          (Commit( B2, P2, <r, 'Bank', t> ) @ #i2) ∧ (¬(#i2 = #i))))) ∨
     (∃ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ B P r t #i.
  (Commit( B, P, <r, 'Bank', t> ) @ #i)
 ∧
  (((∀ #j. (Running( P, B, <r, 'Bank', t> ) @ #j) ⇒ ¬(#j < #i)) ∨
    (∃ B2 P2 #i2.
      (Commit( B2, P2, <r, 'Bank', t> ) @ #i2) ∧ ¬(#i2 = #i)))) ∧
  (∀ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k) ⇒ ⊥)"
*/
by sorry

lemma secrecy_MK:
  all-traces
  "∀ MK #i.
    (SecretMK( MK ) @ #i) ⇒
    ((¬(∃ #j. !KU( MK ) @ #j)) ∨
     (∃ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ MK #i.
  (SecretMK( MK ) @ #i)
 ∧
  (∃ #j. (!KU( MK ) @ #j)) ∧
  (∀ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k) ⇒ ⊥)"
*/
by sorry

lemma secrecy_privkCard:
  all-traces
  "∀ privkCard #i.
    (SecretPrivkCard( privkCard ) @ #i) ⇒
    ((¬(∃ #j. !KU( privkCard ) @ #j)) ∨
     (∃ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ privkCard #i.
  (SecretPrivkCard( privkCard ) @ #i)
 ∧
  (∃ #j. (!KU( privkCard ) @ #j)) ∧
  (∀ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k) ⇒ ⊥)"
*/
by sorry

lemma secrecy_PIN:
  all-traces
  "∀ PIN #i.
    (SecretPIN( PIN ) @ #i) ⇒
    ((¬(∃ #j. !KU( PIN ) @ #j)) ∨
     (∃ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ PIN #i.
  (SecretPIN( PIN ) @ #i)
 ∧
  (∃ #j. (!KU( PIN ) @ #j)) ∧
  (∀ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k) ⇒ ⊥)"
*/
by sorry

lemma secrecy_PAN:
  all-traces
  "∀ PAN #i.
    (SecretPAN( PAN ) @ #i) ⇒
    ((¬(∃ #j. !KU( PAN ) @ #j)) ∨
     (∃ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ PAN #i.
  (SecretPAN( PAN ) @ #i)
 ∧
  (∃ #j. (!KU( PAN ) @ #j)) ∧
  (∀ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k) ⇒ ⊥)"
*/
by sorry

lemma secrecy_SIGMA:
  all-traces
  "∀ S #i.
    (Secret_Sigma( S ) @ #i) ⇒
    ((¬(∃ #j. !KU( S ) @ #j)) ∨
     (∃ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ S #i.
  (Secret_Sigma( S ) @ #i)
 ∧
  (∃ #j. (!KU( S ) @ #j)) ∧
  (∀ A #k. (Honest( A ) @ #i) ∧ (Compromise( A ) @ #k) ⇒ ⊥)"
*/
simplify
solve( Secret_Sigma( S ) @ #i )
  case Terminal_Commits_ARQC
  solve( Recv( $Bank, $Terminal, <~channelID, '2'>, <'ARC', ARPC>
         ) ▶₂ #i )
    case Terminal_Bank_Network_case_1
    solve( Recv( $Terminal, $Bank, <~channelID, '1'>,
                 <
                  <~PAN.1, <'CDA', furtherData.1>, CVM.1, 
                   <<$amount.1, country.1, currency.1, date.1, type.1, UN.1>, CDOL1.1
                   >, 
                   ATC.1, DH, 
                   MAC(f(~MK, ATC.1),
                       <
                        <<$amount.1, country.1, currency.1, date.1, type.1, UN.1>, CDOL1.1
                        >, 
                        <'CDA', furtherData.1>, ATC.1, IAD.1>), 
                   IAD.1, AID>, 
                  'Null'>
           ) ▶₀ #vr.6 )
      case Terminal_Bank_Network
      solve( !KU( sign(<'04', ~PAN.1, pk(x.1), $Bank, supportedCVM, 
                        'CDA', 'ODCVM', furtherData2>,
                       x)
             ) @ #vk.44 )
        case c_sign
        solve( !KU( ~PAN.1 ) @ #vk.17 )
          case Card_Responds_To_ReadRecord_NotDDA_case_1
          solve( Terminal_Received_AC( $Terminal, $Bank, $CA, nc, 'ARQC',
                                       <~PAN, <'CDA', furtherData>, CVM, 
                                        <<$amount, country, currency, date, type, ~UN>, CDOL1>, 
                                        ATC, <Card_Eph_Pk, Terminal_Eph_Pk, S>, AC, IAD, 
                                        'Mastercard'>,
                                       'OnlinePIN', ~channelID
                 ) ▶₀ #i )
            case Terminal_Receives_AC_CDA
            solve( !Value( $amount, 'High' ) ▶₁ #i )
              case Generate_Amount_High
              solve( !KU( MAC(f(~MK, ATC),
                              <
                               <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                'TVR', 'ODCVM', 'HHMMSS'>, 
                               <'CDA', 'ODCVM', furtherData2>, ATC, IAD>)
                     ) @ #vk.16 )
                case c_MAC
                solve( !KU( ~UN ) @ #vk.77 )
                  case Terminal_Sends_GPO
                  solve( !KU( sign(<'05', nc, 'ARQC', 
                                    MAC(f(~MK, ATC),
                                        <
                                         <
                                          <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN
                                          >, 
                                          'TVR', 'ODCVM', 'HHMMSS'>, 
                                         <'CDA', 'ODCVM', furtherData2>, ATC, IAD>), 
                                    h(<
                                       <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                        'TVR', 'ODCVM', 'HHMMSS'>, 
                                       'ARQC', ATC, 
                                       MAC(f(~MK, ATC),
                                           <
                                            <
                                             <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                              ~UN>, 
                                             'TVR', 'ODCVM', 'HHMMSS'>, 
                                            <'CDA', 'ODCVM', furtherData2>, ATC, IAD>), 
                                       IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>), 
                                    ~UN>,
                                   x)
                         ) @ #vk.25 )
                    case c_sign
                    solve( !KU( pk(x.1) ) @ #vk.48 )
                      case Card_Responds_To_ReadRecord_NotDDA_case_1
                      solve( !KU( ~privkBank ) @ #vk.74 )
                        case Compromise_Bank
                        solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                               ) @ #vk.53 )
                          case Card_Responds_To_ReadRecord_NotDDA
                          by contradiction
                        next
                          case c_sign
                          solve( !KU( ~privkCA ) @ #vk.95 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case Card_Responds_To_ReadRecord_NotDDA_case_2
                      solve( !KU( ~privkBank ) @ #vk.73 )
                        case Compromise_Bank
                        solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                               ) @ #vk.52 )
                          case Card_Responds_To_ReadRecord_NotDDA
                          by contradiction
                        next
                          case c_sign
                          solve( !KU( ~privkCA ) @ #vk.96 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case Card_Responds_To_ReadRecord_NotDDA_case_3
                      solve( !KU( ~privkCard ) @ #vk.73 )
                        case Compromise_Card
                        solve( !KU( sign(<'02', $Bank, pk(~privkCard), $CA>, ~privkCA)
                               ) @ #vk.52 )
                          case c_sign
                          solve( !KU( ~privkCA ) @ #vk.96 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case Create_Bank
                      solve( !KU( ~privkBank ) @ #vk.72 )
                        case Compromise_Bank
                        solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                               ) @ #vk.52 )
                          case Card_Responds_To_ReadRecord_NotDDA_case_1
                          by contradiction
                        next
                          case Card_Responds_To_ReadRecord_NotDDA_case_2
                          by contradiction
                        next
                          case c_sign
                          solve( !KU( ~privkCA ) @ #vk.89 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case Create_CA
                      solve( !KU( ~privkCA ) @ #vk.72 )
                        case Compromise_CA
                        solve( !KU( sign(<'02', $Bank, pk(~privkCA), $CA>, ~privkCA.1)
                               ) @ #vk.52 )
                          case c_sign
                          solve( !KU( ~privkCA.1 ) @ #vk.89 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case Set_Records_NotSDA
                      solve( !KU( ~privkCard ) @ #vk.72 )
                        case Compromise_Card
                        solve( !KU( sign(<'02', $Bank, pk(~privkCard), $CA>, ~privkCA)
                               ) @ #vk.52 )
                          case c_sign
                          solve( !KU( ~privkCA ) @ #vk.92 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case c_pk
                      solve( !KU( sign(<'02', $Bank, pk(x.1), $CA>, ~privkCA)
                             ) @ #vk.51 )
                        case Card_Responds_To_ReadRecord_NotDDA_case_1
                        solve( !KU( ~privkBank ) @ #vk.74 )
                          case Compromise_Bank
                          by contradiction
                        qed
                      next
                        case Card_Responds_To_ReadRecord_NotDDA_case_2
                        solve( !KU( ~privkBank ) @ #vk.73 )
                          case Compromise_Bank
                          by contradiction
                        qed
                      next
                        case c_sign
                        solve( !KU( ~privkCA ) @ #vk.89 )
                          case Compromise_CA
                          by contradiction
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        next
          case Card_Responds_To_ReadRecord_NotDDA_case_2
          solve( Terminal_Received_AC( $Terminal, $Bank, $CA, nc, 'ARQC',
                                       <~PAN, <'CDA', furtherData>, CVM, 
                                        <<$amount, country, currency, date, type, ~UN>, CDOL1>, 
                                        ATC, <Card_Eph_Pk, Terminal_Eph_Pk, S>, AC, IAD, 
                                        'Mastercard'>,
                                       'OnlinePIN', ~channelID
                 ) ▶₀ #i )
            case Terminal_Receives_AC_CDA
            solve( !Value( $amount, 'High' ) ▶₁ #i )
              case Generate_Amount_High
              solve( !KU( MAC(f(~MK, ATC),
                              <
                               <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                'TVR', 'ODCVM', 'HHMMSS'>, 
                               <'CDA', 'ODCVM', furtherData2>, ATC, IAD>)
                     ) @ #vk.16 )
                case c_MAC
                solve( !KU( ~UN ) @ #vk.77 )
                  case Terminal_Sends_GPO
                  solve( !KU( sign(<'05', nc, 'ARQC', 
                                    MAC(f(~MK, ATC),
                                        <
                                         <
                                          <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN
                                          >, 
                                          'TVR', 'ODCVM', 'HHMMSS'>, 
                                         <'CDA', 'ODCVM', furtherData2>, ATC, IAD>), 
                                    h(<
                                       <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                        'TVR', 'ODCVM', 'HHMMSS'>, 
                                       'ARQC', ATC, 
                                       MAC(f(~MK, ATC),
                                           <
                                            <
                                             <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                              ~UN>, 
                                             'TVR', 'ODCVM', 'HHMMSS'>, 
                                            <'CDA', 'ODCVM', furtherData2>, ATC, IAD>), 
                                       IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>), 
                                    ~UN>,
                                   x)
                         ) @ #vk.25 )
                    case c_sign
                    solve( !KU( pk(x.1) ) @ #vk.48 )
                      case Card_Responds_To_ReadRecord_NotDDA_case_1
                      solve( !KU( ~privkBank ) @ #vk.73 )
                        case Compromise_Bank
                        solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                               ) @ #vk.52 )
                          case Card_Responds_To_ReadRecord_NotDDA
                          by contradiction
                        next
                          case c_sign
                          solve( !KU( ~privkCA ) @ #vk.96 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case Card_Responds_To_ReadRecord_NotDDA_case_2
                      solve( !KU( ~privkBank ) @ #vk.73 )
                        case Compromise_Bank
                        solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                               ) @ #vk.52 )
                          case Card_Responds_To_ReadRecord_NotDDA
                          by contradiction
                        next
                          case c_sign
                          solve( !KU( ~privkCA ) @ #vk.96 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case Card_Responds_To_ReadRecord_NotDDA_case_3
                      solve( !KU( ~privkCard ) @ #vk.73 )
                        case Compromise_Card
                        solve( !KU( sign(<'02', $Bank, pk(~privkCard), $CA>, ~privkCA)
                               ) @ #vk.52 )
                          case c_sign
                          solve( !KU( ~privkCA ) @ #vk.96 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case Create_Bank
                      solve( !KU( ~privkBank ) @ #vk.72 )
                        case Compromise_Bank
                        solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                               ) @ #vk.52 )
                          case Card_Responds_To_ReadRecord_NotDDA_case_1
                          by contradiction
                        next
                          case Card_Responds_To_ReadRecord_NotDDA_case_2
                          by contradiction
                        next
                          case c_sign
                          solve( !KU( ~privkCA ) @ #vk.89 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case Create_CA
                      solve( !KU( ~privkCA ) @ #vk.72 )
                        case Compromise_CA
                        solve( !KU( sign(<'02', $Bank, pk(~privkCA), $CA>, ~privkCA.1)
                               ) @ #vk.52 )
                          case c_sign
                          solve( !KU( ~privkCA.1 ) @ #vk.89 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case Set_Records_NotSDA
                      solve( !KU( ~privkCard ) @ #vk.72 )
                        case Compromise_Card
                        solve( !KU( sign(<'02', $Bank, pk(~privkCard), $CA>, ~privkCA)
                               ) @ #vk.52 )
                          case c_sign
                          solve( !KU( ~privkCA ) @ #vk.92 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case c_pk
                      solve( !KU( sign(<'02', $Bank, pk(x.1), $CA>, ~privkCA)
                             ) @ #vk.51 )
                        case Card_Responds_To_ReadRecord_NotDDA_case_1
                        solve( !KU( ~privkBank ) @ #vk.73 )
                          case Compromise_Bank
                          by contradiction
                        qed
                      next
                        case Card_Responds_To_ReadRecord_NotDDA_case_2
                        solve( !KU( ~privkBank ) @ #vk.73 )
                          case Compromise_Bank
                          by contradiction
                        qed
                      next
                        case c_sign
                        solve( !KU( ~privkCA ) @ #vk.89 )
                          case Compromise_CA
                          by contradiction
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        next
          case Card_Responds_To_ReadRecord_NotDDA_case_3
          solve( Terminal_Received_AC( $Terminal, $Bank, $CA, nc, 'ARQC',
                                       <~PAN, <'CDA', furtherData>, CVM, 
                                        <<$amount, country, currency, date, type, ~UN>, CDOL1>, 
                                        ATC, <Card_Eph_Pk, Terminal_Eph_Pk, S>, AC, IAD, 
                                        'Mastercard'>,
                                       'OnlinePIN', ~channelID
                 ) ▶₀ #i )
            case Terminal_Receives_AC_CDA
            solve( !Value( $amount, 'High' ) ▶₁ #i )
              case Generate_Amount_High
              solve( !KU( MAC(f(~MK, ATC),
                              <
                               <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                'TVR', 'ODCVM', 'HHMMSS'>, 
                               <'CDA', 'ODCVM', furtherData2>, ATC, IAD>)
                     ) @ #vk.16 )
                case c_MAC
                solve( !KU( ~UN ) @ #vk.77 )
                  case Terminal_Sends_GPO
                  solve( !KU( sign(<'05', nc, 'ARQC', 
                                    MAC(f(~MK, ATC),
                                        <
                                         <
                                          <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN
                                          >, 
                                          'TVR', 'ODCVM', 'HHMMSS'>, 
                                         <'CDA', 'ODCVM', furtherData2>, ATC, IAD>), 
                                    h(<
                                       <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                        'TVR', 'ODCVM', 'HHMMSS'>, 
                                       'ARQC', ATC, 
                                       MAC(f(~MK, ATC),
                                           <
                                            <
                                             <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                              ~UN>, 
                                             'TVR', 'ODCVM', 'HHMMSS'>, 
                                            <'CDA', 'ODCVM', furtherData2>, ATC, IAD>), 
                                       IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>), 
                                    ~UN>,
                                   x)
                         ) @ #vk.25 )
                    case c_sign
                    solve( !KU( pk(x.1) ) @ #vk.48 )
                      case Card_Responds_To_ReadRecord_NotDDA_case_1
                      solve( !KU( ~privkBank ) @ #vk.73 )
                        case Compromise_Bank
                        solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                               ) @ #vk.52 )
                          case Card_Responds_To_ReadRecord_NotDDA
                          by contradiction
                        next
                          case c_sign
                          solve( !KU( ~privkCA ) @ #vk.96 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case Card_Responds_To_ReadRecord_NotDDA_case_2
                      solve( !KU( ~privkBank ) @ #vk.73 )
                        case Compromise_Bank
                        solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                               ) @ #vk.52 )
                          case Card_Responds_To_ReadRecord_NotDDA
                          by contradiction
                        next
                          case c_sign
                          solve( !KU( ~privkCA ) @ #vk.96 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case Card_Responds_To_ReadRecord_NotDDA_case_3
                      solve( !KU( ~privkCard ) @ #vk.73 )
                        case Compromise_Card
                        solve( !KU( sign(<'02', $Bank, pk(~privkCard), $CA>, ~privkCA)
                               ) @ #vk.52 )
                          case c_sign
                          solve( !KU( ~privkCA ) @ #vk.96 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case Create_Bank
                      solve( !KU( ~privkBank ) @ #vk.72 )
                        case Compromise_Bank
                        solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                               ) @ #vk.52 )
                          case Card_Responds_To_ReadRecord_NotDDA_case_1
                          by contradiction
                        next
                          case Card_Responds_To_ReadRecord_NotDDA_case_2
                          by contradiction
                        next
                          case c_sign
                          solve( !KU( ~privkCA ) @ #vk.89 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case Create_CA
                      solve( !KU( ~privkCA ) @ #vk.72 )
                        case Compromise_CA
                        solve( !KU( sign(<'02', $Bank, pk(~privkCA), $CA>, ~privkCA.1)
                               ) @ #vk.52 )
                          case c_sign
                          solve( !KU( ~privkCA.1 ) @ #vk.89 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case Set_Records_NotSDA
                      solve( !KU( ~privkCard ) @ #vk.72 )
                        case Compromise_Card
                        solve( !KU( sign(<'02', $Bank, pk(~privkCard), $CA>, ~privkCA)
                               ) @ #vk.52 )
                          case c_sign
                          solve( !KU( ~privkCA ) @ #vk.92 )
                            case Compromise_CA
                            by contradiction
                          qed
                        qed
                      qed
                    next
                      case c_pk
                      solve( !KU( sign(<'02', $Bank, pk(x.1), $CA>, ~privkCA)
                             ) @ #vk.51 )
                        case Card_Responds_To_ReadRecord_NotDDA_case_1
                        solve( !KU( ~privkBank ) @ #vk.73 )
                          case Compromise_Bank
                          by contradiction
                        qed
                      next
                        case Card_Responds_To_ReadRecord_NotDDA_case_2
                        solve( !KU( ~privkBank ) @ #vk.73 )
                          case Compromise_Bank
                          by contradiction
                        qed
                      next
                        case c_sign
                        solve( !KU( ~privkCA ) @ #vk.89 )
                          case Compromise_CA
                          by contradiction
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        next
          case Compromise_Card
          solve( Terminal_Received_AC( $Terminal, $Bank, $CA, nc, 'ARQC',
                                       <~PAN, <'CDA', furtherData>, CVM, 
                                        <<$amount, country, currency, date, type, ~UN>, CDOL1>, 
                                        ATC, <Card_Eph_Pk, Terminal_Eph_Pk, S>, AC, IAD, 
                                        'Mastercard'>,
                                       'OnlinePIN', ~channelID
                 ) ▶₀ #i )
            case Terminal_Receives_AC_CDA
            by contradiction
          qed
        qed
      qed
    qed
  next
    case Terminal_Bank_Network_case_2
    solve( Recv( $Terminal, $Bank, <~channelID, '1'>,
                 <
                  <~PAN.1, <'CDA', furtherData.1>, 'OnlinePIN', 
                   <<$amount.1, country.1, currency.1, date.1, type.1, UN.1>, CDOL1.1
                   >, 
                   ATC.1, DH, 
                   MAC(f(~MK, ATC.1),
                       <
                        <<$amount.1, country.1, currency.1, date.1, type.1, UN.1>, CDOL1.1
                        >, 
                        <'CDA', furtherData.1>, ATC.1, IAD.1>), 
                   IAD.1, AID>, 
                  aenc(~PIN, pk(~privkBank))>
           ) ▶₀ #vr.6 )
      case Terminal_Bank_Network
      solve( !KU( sign(<'04', ~PAN.1, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                        furtherData.1>,
                       ~privkBank)
             ) @ #vk.44 )
        case Card_Responds_To_ReadRecord_NotDDA
        solve( !KU( ~PAN.1 ) @ #vk.20 )
          case Card_Responds_To_ReadRecord_NotDDA_case_1
          solve( Terminal_Received_AC( $Terminal, $Bank, $CA, nc, 'ARQC',
                                       <~PAN, <'CDA', furtherData>, CVM, 
                                        <<$amount, country, currency, date, type, ~UN>, CDOL1>, 
                                        ATC, <Card_Eph_Pk, Terminal_Eph_Pk, S>, AC, IAD, 
                                        'Mastercard'>,
                                       'OnlinePIN', ~channelID
                 ) ▶₀ #i )
            case Terminal_Receives_AC_CDA
            solve( !Value( $amount, 'High' ) ▶₁ #i )
              case Generate_Amount_High
              solve( !KU( MAC(f(~MK, ATC),
                              <
                               <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                'TVR', 'OnlinePIN', 'HHMMSS'>, 
                               <'CDA', $furtherData>, ATC, IAD>)
                     ) @ #vk.23 )
                case Card_Responds_To_GenerateAC_CDA
                solve( !KU( ~UN ) @ #vk.78 )
                  case Terminal_Sends_GPO
                  solve( !KU( sign(<'05', nc.1, 'ARQC', 
                                    MAC(f(~MK, ~ATC),
                                        <
                                         <
                                          <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN
                                          >, 
                                          'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                         <'CDA', $furtherData>, ~ATC, 'IAD', CID>), 
                                    h(<
                                       <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                        'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                       'ARQC', ~ATC, 
                                       MAC(f(~MK, ~ATC),
                                           <
                                            <
                                             <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                              ~UN>, 
                                             'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                            <'CDA', $furtherData>, ~ATC, 'IAD', CID>), 
                                       <'IAD', CID>, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>), 
                                    ~UN>,
                                   ~privkCard)
                         ) @ #vk.32 )
                    case Card_Responds_To_GenerateAC_CDA
                    solve( !KU( ~ATC ) @ #vk.33 )
                      case Card_Responds_To_GenerateAC_CDA
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.79 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.65 )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                                 ) @ #vk.58 )
                            case Card_Responds_To_ReadRecord_NotDDA_case_1
                            solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                              'MAC_CARD_TO_READER'),
                                            <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                                   ) @ #vk.68 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( ~nc ) @ #vk.52 )
                                case Card_Responds_To_GenerateAC_CDA
                                solve( !KU( pk(~privkBank) ) @ #vk.61 )
                                  case Card_Responds_To_ReadRecord_NotDDA
                                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                    case Card_Ext_Responds_To_Hello
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.109 )
                                  next
                                    case Terminal_Ext_Sends_Hello
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                                  next
                                    case c_exp
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                  qed
                                next
                                  case Create_Bank
                                  solve( !KU( pk(~privkCard) ) @ #vk.63 )
                                    case Card_Responds_To_ReadRecord_NotDDA
                                    solve( splitEqs(2) )
                                      case split_case_1
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.109 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      qed
                                    next
                                      case split_case_2
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.109 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      qed
                                    next
                                      case split_case_3
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.109 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      qed
                                    next
                                      case split_case_4
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.109 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      qed
                                    next
                                      case split_case_5
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.109 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      qed
                                    next
                                      case split_case_6
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.109 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      qed
                                    qed
                                  next
                                    case Set_Records_NotSDA
                                    solve( splitEqs(2) )
                                      case split_case_1
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.109 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      qed
                                    next
                                      case split_case_2
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.109 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      qed
                                    next
                                      case split_case_3
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.109 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      qed
                                    next
                                      case split_case_4
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.109 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      qed
                                    next
                                      case split_case_5
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.109 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      qed
                                    next
                                      case split_case_6
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.109 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      qed
                                    qed
                                  next
                                    case c_pk
                                    solve( !KU( ~privkCard ) @ #vk.109 )
                                      case Compromise_Card
                                      by contradiction
                                    qed
                                  qed
                                next
                                  case c_pk
                                  solve( !KU( ~privkBank ) @ #vk.109 )
                                    case Compromise_Bank
                                    by contradiction
                                  qed
                                qed
                              qed
                            next
                              case c_MAC
                              solve( !KU( ~nc ) @ #vk.53 )
                                case Card_Responds_To_GenerateAC_CDA
                                solve( !KU( pk(~privkBank) ) @ #vk.62 )
                                  case Card_Responds_To_ReadRecord_NotDDA
                                  solve( !KU( pk(~privkCard) ) @ #vk.64 )
                                    case Card_Responds_To_ReadRecord_NotDDA
                                    solve( splitEqs(2) )
                                      case split_case_1
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_2
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_3
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_4
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_5
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_6
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    qed
                                  next
                                    case Set_Records_NotSDA
                                    solve( splitEqs(2) )
                                      case split_case_1
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_2
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_3
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_4
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_5
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_6
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    qed
                                  next
                                    case c_pk
                                    solve( !KU( ~privkCard ) @ #vk.111 )
                                      case Compromise_Card
                                      by contradiction
                                    qed
                                  qed
                                next
                                  case Create_Bank
                                  solve( !KU( pk(~privkCard) ) @ #vk.64 )
                                    case Card_Responds_To_ReadRecord_NotDDA
                                    solve( splitEqs(2) )
                                      case split_case_1
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_2
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_3
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_4
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_5
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_6
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    qed
                                  next
                                    case Set_Records_NotSDA
                                    solve( splitEqs(2) )
                                      case split_case_1
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_2
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_3
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_4
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_5
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    next
                                      case split_case_6
                                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                        case Card_Ext_Responds_To_Hello
                                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                      next
                                        case Terminal_Ext_Sends_Hello
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                      next
                                        case c_exp
                                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                      qed
                                    qed
                                  next
                                    case c_pk
                                    solve( !KU( ~privkCard ) @ #vk.111 )
                                      case Compromise_Card
                                      by contradiction
                                    qed
                                  qed
                                next
                                  case c_pk
                                  solve( !KU( ~privkBank ) @ #vk.111 )
                                    case Compromise_Bank
                                    by contradiction
                                  qed
                                qed
                              qed
                            qed
                          next
                            case Card_Responds_To_ReadRecord_NotDDA_case_2
                            solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                              'MAC_CARD_TO_READER'),
                                            <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                                   ) @ #vk.68 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.109 )
                                qed
                              next
                                case Terminal_Ext_Sends_Hello
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                qed
                              qed
                            next
                              case c_MAC
                              solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.111 )
                                qed
                              next
                                case Terminal_Ext_Sends_Hello
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.113 )
                                qed
                              qed
                            qed
                          next
                            case c_sign
                            solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                              'MAC_CARD_TO_READER'),
                                            <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                                   ) @ #vk.67 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.102 )
                                    case Compromise_CA
                                    by contradiction
                                  qed
                                qed
                              next
                                case Terminal_Ext_Sends_Hello
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.102 )
                                    case Compromise_CA
                                    by contradiction
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.102 )
                                    case Compromise_CA
                                    by contradiction
                                  qed
                                qed
                              qed
                            next
                              case c_MAC
                              solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.103 )
                                    case Compromise_CA
                                    by contradiction
                                  qed
                                qed
                              next
                                case Terminal_Ext_Sends_Hello
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.103 )
                                    case Compromise_CA
                                    by contradiction
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.103 )
                                    case Compromise_CA
                                    by contradiction
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                            'MAC_CARD_TO_READER'),
                                          <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                                 ) @ #vk.67 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( ~nc ) @ #vk.50 )
                                case Card_Responds_To_GenerateAC_CDA
                                by solve( !KU( ~Card_Eph_Sk ) @ #vk.103 )
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( ~nc ) @ #vk.50 )
                                case Card_Responds_To_GenerateAC_CDA
                                by solve( !KU( ~Card_Eph_Sk ) @ #vk.103 )
                              qed
                            next
                              case c_exp
                              solve( !KU( ~nc ) @ #vk.50 )
                                case Card_Responds_To_GenerateAC_CDA
                                by solve( !KU( ~Card_Eph_Sk ) @ #vk.103 )
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( ~nc ) @ #vk.51 )
                                case Card_Responds_To_GenerateAC_CDA
                                by solve( !KU( ~Card_Eph_Sk ) @ #vk.104 )
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( ~nc ) @ #vk.51 )
                                case Card_Responds_To_GenerateAC_CDA
                                by solve( !KU( ~Card_Eph_Sk ) @ #vk.104 )
                              qed
                            next
                              case c_exp
                              solve( !KU( ~nc ) @ #vk.51 )
                                case Card_Responds_To_GenerateAC_CDA
                                by solve( !KU( ~Card_Eph_Sk ) @ #vk.104 )
                              qed
                            qed
                          qed
                        qed
                      next
                        case c_exp
                        solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                               ) @ #vk.55 )
                          case Card_Responds_To_ReadRecord_NotDDA_case_1
                          solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                            'MAC_CARD_TO_READER'),
                                          <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                                 ) @ #vk.68 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.68 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.105 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.105 )
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.68 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.105 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.105 )
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.68 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.105 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.105 )
                                qed
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.106 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.106 )
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.106 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.106 )
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.106 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.106 )
                                qed
                              qed
                            qed
                          qed
                        next
                          case Card_Responds_To_ReadRecord_NotDDA_case_2
                          solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                            'MAC_CARD_TO_READER'),
                                          <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                                 ) @ #vk.68 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.68 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.105 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.105 )
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.68 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.105 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.105 )
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.68 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.105 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.105 )
                                qed
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.106 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.106 )
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.106 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.106 )
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.106 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.106 )
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_sign
                          solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                            'MAC_CARD_TO_READER'),
                                          <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                                 ) @ #vk.67 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.67 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.103 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.103 )
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.67 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.103 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.103 )
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.67 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.103 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.52 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.103 )
                                qed
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.68 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.104 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.104 )
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.68 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.104 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.104 )
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.68 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.104 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.53 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.104 )
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case Generate_ATC
                      solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                             ) @ #vk.51 )
                        case Card_Responds_To_ReadRecord_NotDDA_case_1
                        solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                          'MAC_CARD_TO_READER'),
                                        <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                               ) @ #vk.62 )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.74 )
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_MAC
                          solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.75 )
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.64 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.64 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.64 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.64 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.64 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.64 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case Card_Responds_To_ReadRecord_NotDDA_case_2
                        solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                          'MAC_CARD_TO_READER'),
                                        <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                               ) @ #vk.62 )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.74 )
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_MAC
                          solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.75 )
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.64 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.64 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.64 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.64 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.64 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.64 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case c_sign
                        solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                          'MAC_CARD_TO_READER'),
                                        <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                               ) @ #vk.61 )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.72 )
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.62 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.79 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.79 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.62 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.79 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.79 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.62 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.79 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.79 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.62 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.79 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.79 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.62 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.79 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.79 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.62 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.79 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.48 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.79 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_MAC
                          solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.73 )
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.80 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.80 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.80 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.80 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.80 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.80 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.80 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.80 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.80 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.80 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.63 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.80 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~nc ) @ #vk.49 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCA ) @ #vk.80 )
                                    case Compromise_CA
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case c_sign
                    solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                           ) @ #vk.55 )
                      case Card_Responds_To_ReadRecord_NotDDA_case_1
                      solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                      <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                             ) @ #vk.67 )
                        case Card_Ext_Responds_To_Hello
                        solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.97 )
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( h(<
                                             <
                                              <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                               ~UN>, 
                                              'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                             'ARQC', ~ATC, 
                                             MAC(f(~MK, ~ATC),
                                                 <
                                                  <
                                                   <$amount, 'Switzerland', 'CHF', 'YYMMDD', 
                                                    'Purchase', ~UN>, 
                                                   'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                                  <'CDA', $furtherData>, ~ATC, 'IAD', CID>), 
                                             <'IAD', CID>, 'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                                     ) @ #vk.92 )
                                case c_h
                                solve( !KU( ~ATC ) @ #vk.56 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( h(<
                                             <
                                              <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                               ~UN>, 
                                              'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                             'ARQC', ~ATC, 
                                             MAC(f(~MK, ~ATC),
                                                 <
                                                  <
                                                   <$amount, 'Switzerland', 'CHF', 'YYMMDD', 
                                                    'Purchase', ~UN>, 
                                                   'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                                  <'CDA', $furtherData>, ~ATC, 'IAD', CID>), 
                                             <'IAD', CID>, 'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                                     ) @ #vk.92 )
                                case c_h
                                solve( !KU( ~ATC ) @ #vk.56 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( h(<
                                           <
                                            <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                             ~UN>, 
                                            'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                           'ARQC', ~ATC, 
                                           MAC(f(~MK, ~ATC),
                                               <
                                                <
                                                 <$amount, 'Switzerland', 'CHF', 'YYMMDD', 
                                                  'Purchase', ~UN>, 
                                                 'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                                <'CDA', $furtherData>, ~ATC, 'IAD', CID>), 
                                           <'IAD', CID>, 'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                                   ) @ #vk.92 )
                              case c_h
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.76 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( h(<
                                           <
                                            <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                             ~UN>, 
                                            'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                           'ARQC', ~ATC, 
                                           MAC(f(~MK, ~ATC),
                                               <
                                                <
                                                 <$amount, 'Switzerland', 'CHF', 'YYMMDD', 
                                                  'Purchase', ~UN>, 
                                                 'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                                <'CDA', $furtherData>, ~ATC, 'IAD', CID>), 
                                           <'IAD', CID>, 'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                                   ) @ #vk.92 )
                              case c_h
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.76 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( h(<
                                         <
                                          <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN
                                          >, 
                                          'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                         'ARQC', ~ATC, 
                                         MAC(f(~MK, ~ATC),
                                             <
                                              <
                                               <$amount, 'Switzerland', 'CHF', 'YYMMDD', 
                                                'Purchase', ~UN>, 
                                               'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                              <'CDA', $furtherData>, ~ATC, 'IAD', CID>), 
                                         <'IAD', CID>, 'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                                 ) @ #vk.92 )
                            case c_h
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.77 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.77 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.77 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case c_MAC
                        solve( !KU( h(<
                                       <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                        'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                       'ARQC', ~ATC, 
                                       MAC(f(~MK, ~ATC),
                                           <
                                            <
                                             <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                              ~UN>, 
                                             'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                            <'CDA', $furtherData>, ~ATC, 'IAD', CID>), 
                                       <'IAD', CID>, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                               ) @ #vk.90 )
                          case c_h
                          solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.102 )
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( ~ATC ) @ #vk.55 )
                              case Card_Responds_To_GenerateAC_CDA
                              solve( !KU( ~privkCard ) @ #vk.103 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            next
                              case Generate_ATC
                              solve( !KU( ~privkCard ) @ #vk.96 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( ~ATC ) @ #vk.55 )
                              case Card_Responds_To_GenerateAC_CDA
                              solve( !KU( ~privkCard ) @ #vk.103 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            next
                              case Generate_ATC
                              solve( !KU( ~privkCard ) @ #vk.96 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case Card_Responds_To_ReadRecord_NotDDA_case_2
                      solve( !KU( h(<
                                     <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                      'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                     'ARQC', ~ATC, 
                                     MAC(f(~MK, ~ATC),
                                         <
                                          <
                                           <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN
                                           >, 
                                           'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                          <'CDA', $furtherData>, ~ATC, 'IAD', CID>), 
                                     <'IAD', CID>, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                             ) @ #vk.89 )
                        case c_h
                        solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                        <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                               ) @ #vk.74 )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.104 )
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.77 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.77 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.77 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.77 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.77 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.77 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.105 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.98 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_MAC
                          solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.102 )
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( ~ATC ) @ #vk.54 )
                              case Card_Responds_To_GenerateAC_CDA
                              solve( !KU( ~privkCard ) @ #vk.103 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            next
                              case Generate_ATC
                              solve( !KU( ~privkCard ) @ #vk.96 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( ~ATC ) @ #vk.54 )
                              case Card_Responds_To_GenerateAC_CDA
                              solve( !KU( ~privkCard ) @ #vk.103 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            next
                              case Generate_ATC
                              solve( !KU( ~privkCard ) @ #vk.96 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case c_sign
                      solve( !KU( h(<
                                     <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                      'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                     'ARQC', ~ATC, 
                                     MAC(f(~MK, ~ATC),
                                         <
                                          <
                                           <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN
                                           >, 
                                           'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                          <'CDA', $furtherData>, ~ATC, 'IAD', CID>), 
                                     <'IAD', CID>, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                             ) @ #vk.87 )
                        case c_h
                        solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                        <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                               ) @ #vk.73 )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.98 )
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.76 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.103 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.96 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.103 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.96 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.76 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.103 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.96 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.103 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.96 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.76 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.103 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.96 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.103 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.96 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.76 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.103 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.96 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.103 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.96 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case Terminal_Ext_Sends_Hello
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.76 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.103 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.96 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.103 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.96 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.76 )
                                case Card_Ext_Responds_To_Hello
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.103 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.96 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~ATC ) @ #vk.59 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~privkCard ) @ #vk.103 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~privkCard ) @ #vk.96 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_MAC
                          solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.96 )
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( ~ATC ) @ #vk.54 )
                              case Card_Responds_To_GenerateAC_CDA
                              solve( !KU( ~privkCard ) @ #vk.101 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            next
                              case Generate_ATC
                              solve( !KU( ~privkCard ) @ #vk.94 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( ~ATC ) @ #vk.54 )
                              case Card_Responds_To_GenerateAC_CDA
                              solve( !KU( ~privkCard ) @ #vk.101 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            next
                              case Generate_ATC
                              solve( !KU( ~privkCard ) @ #vk.94 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case c_MAC
                solve( !KU( sign(<'05', nc, 'ARQC', 
                                  MAC(f(~MK, ATC),
                                      <
                                       <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                        'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                       <'CDA', $furtherData>, ATC, IAD>), 
                                  h(<
                                     <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                      'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                     'ARQC', ATC, 
                                     MAC(f(~MK, ATC),
                                         <
                                          <
                                           <$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN
                                           >, 
                                           'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                          <'CDA', $furtherData>, ATC, IAD>), 
                                     IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>), 
                                  ~UN>,
                                 ~privkCard)
                       ) @ #vk.30 )
                  case Card_Responds_To_GenerateAC_CDA
                  solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                         ) @ #vk.46 )
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                      'MAC_CARD_TO_READER'),
                                    <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                           ) @ #vk.59 )
                      case Card_Ext_Responds_To_Hello
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.84 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.99 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.91 )
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.99 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.91 )
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.99 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.99 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.101 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.101 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case c_exp
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.100 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.100 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.100 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.100 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.100 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.100 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case c_MAC
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.85 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.61 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.101 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.101 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.61 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.101 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.101 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.61 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.103 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.103 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case c_exp
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.61 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.61 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.61 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                      'MAC_CARD_TO_READER'),
                                    <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                           ) @ #vk.59 )
                      case Card_Ext_Responds_To_Hello
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.84 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.99 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.91 )
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.99 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.91 )
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.99 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.99 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.101 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.101 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case c_exp
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.100 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.100 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.100 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.100 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.100 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.70 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.81 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.100 )
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.49 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case c_MAC
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.85 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.61 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.101 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.101 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.61 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.101 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.101 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.61 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.103 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.103 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case c_exp
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.61 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.61 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.61 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.71 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.82 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.100 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.50 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                                  'MAC_CARD_TO_READER')
                                           ) @ #vk.92 )
                                      case c_f
                                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case c_sign
                    solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                      'MAC_CARD_TO_READER'),
                                    <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                           ) @ #vk.58 )
                      case Card_Ext_Responds_To_Hello
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.82 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.59 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.68 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.79 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.53 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.92 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.84 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.68 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.79 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.53 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.92 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.84 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.59 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.68 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.79 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.53 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.92 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.84 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.68 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.79 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.92 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.84 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.59 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.68 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.79 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.92 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.84 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.68 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.79 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.55 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.92 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.53 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.84 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case c_exp
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.59 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.68 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.79 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.92 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.84 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.68 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.79 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.92 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.84 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.59 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.68 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.79 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.53 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.92 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.51 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.84 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.68 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.79 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.92 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.52 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.84 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.59 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.68 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.79 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.55 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.92 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.53 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.84 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.68 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.79 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.46 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.55 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.92 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.53 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.84 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case c_MAC
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.83 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.69 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.80 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.56 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.93 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.85 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.69 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.80 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.56 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.93 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.85 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.69 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.80 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.56 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.93 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.85 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.69 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.80 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.56 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.93 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.85 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.69 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.80 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.56 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.93 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.85 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.69 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.80 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.56 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.93 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.85 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case c_exp
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.69 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.80 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.56 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.93 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.85 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.69 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.80 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.56 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.93 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.85 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.69 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.80 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.56 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.93 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.85 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.69 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.80 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.56 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.93 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.85 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.69 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.80 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.56 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.93 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.85 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( f(~MK, ~ATC) ) @ #vk.69 )
                              case c_f
                              solve( !KU( ~UN ) @ #vk.80 )
                                case Terminal_Sends_GPO
                                solve( !KU( ~ATC ) @ #vk.47 )
                                  case Card_Responds_To_GenerateAC_CDA
                                  solve( !KU( ~nc ) @ #vk.56 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.93 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case Generate_ATC
                                  solve( !KU( ~nc ) @ #vk.54 )
                                    case Card_Responds_To_GenerateAC_CDA
                                    solve( !KU( ~privkCA ) @ #vk.85 )
                                      case Compromise_CA
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case c_sign
                  solve( !KU( h(<
                                 <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                  'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                 'ARQC', ATC, 
                                 MAC(f(~MK, ATC),
                                     <
                                      <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                       'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                      <'CDA', $furtherData>, ATC, IAD>), 
                                 IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                         ) @ #vk.83 )
                    case c_h
                    solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                           ) @ #vk.54 )
                      case Card_Responds_To_ReadRecord_NotDDA_case_1
                      solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                      <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                             ) @ #vk.67 )
                        case Card_Ext_Responds_To_Hello
                        solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.94 )
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case c_MAC
                        solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.92 )
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( f(~MK, ATC) ) @ #vk.77 )
                            case c_f
                            solve( !KU( ~UN ) @ #vk.88 )
                              case Terminal_Sends_GPO
                              solve( !KU( ~privkCard ) @ #vk.91 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( f(~MK, ATC) ) @ #vk.77 )
                            case c_f
                            solve( !KU( ~UN ) @ #vk.88 )
                              case Terminal_Sends_GPO
                              solve( !KU( ~privkCard ) @ #vk.91 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case Card_Responds_To_ReadRecord_NotDDA_case_2
                      solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                      <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                             ) @ #vk.67 )
                        case Card_Ext_Responds_To_Hello
                        solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.94 )
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.69 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.79 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.90 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.93 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case c_MAC
                        solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.92 )
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( f(~MK, ATC) ) @ #vk.77 )
                            case c_f
                            solve( !KU( ~UN ) @ #vk.88 )
                              case Terminal_Sends_GPO
                              solve( !KU( ~privkCard ) @ #vk.91 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( f(~MK, ATC) ) @ #vk.77 )
                            case c_f
                            solve( !KU( ~UN ) @ #vk.88 )
                              case Terminal_Sends_GPO
                              solve( !KU( ~privkCard ) @ #vk.91 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case c_sign
                      solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                      <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                             ) @ #vk.66 )
                        case Card_Ext_Responds_To_Hello
                        solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.92 )
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.68 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.77 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.88 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.91 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.77 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.88 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.91 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.68 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.77 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.88 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.91 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.77 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.88 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.91 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.68 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.77 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.88 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.91 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.77 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.88 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.91 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                            case Card_Ext_Responds_To_Hello
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.68 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.77 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.88 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.91 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.77 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.88 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.91 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case Terminal_Ext_Sends_Hello
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.68 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.77 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.88 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.91 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.77 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.88 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.91 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.68 )
                              case Card_Ext_Responds_To_Hello
                              solve( !KU( f(~MK, ATC) ) @ #vk.77 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.88 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.91 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case c_exp
                              solve( !KU( f(~MK, ATC) ) @ #vk.77 )
                                case c_f
                                solve( !KU( ~UN ) @ #vk.88 )
                                  case Terminal_Sends_GPO
                                  solve( !KU( ~privkCard ) @ #vk.91 )
                                    case Compromise_Card
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case c_MAC
                        solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.90 )
                          case Terminal_Ext_Sends_Hello
                          solve( !KU( f(~MK, ATC) ) @ #vk.75 )
                            case c_f
                            solve( !KU( ~UN ) @ #vk.86 )
                              case Terminal_Sends_GPO
                              solve( !KU( ~privkCard ) @ #vk.89 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        next
                          case c_exp
                          solve( !KU( f(~MK, ATC) ) @ #vk.75 )
                            case c_f
                            solve( !KU( ~UN ) @ #vk.86 )
                              case Terminal_Sends_GPO
                              solve( !KU( ~privkCard ) @ #vk.89 )
                                case Compromise_Card
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        next
          case Card_Responds_To_ReadRecord_NotDDA_case_2
          solve( !KU( sign(<'05', nc.1, CID, 
                            MAC(f(~MK, ATC.1),
                                <
                                 <<$amount.1, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN.1>, 
                                  'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                 <'CDA', $furtherData.1>, ATC.1, IAD.1>), 
                            h(<
                               <<$amount.1, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN.1>, 
                                'TVR', 'OnlinePIN', 'HHMMSS'>, 
                               CID, ATC.1, 
                               MAC(f(~MK, ATC.1),
                                   <
                                    <
                                     <$amount.1, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN.1
                                     >, 
                                     'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                    <'CDA', $furtherData.1>, ATC.1, IAD.1>), 
                               IAD.1, Card_Eph_Pk.1, 'g'^~Terminal_Eph_Sk>), 
                            ~UN.1>,
                           ~privkCard)
                 ) @ #vk.21 )
            case Card_Responds_To_GenerateAC_CDA
            solve( Terminal_Received_AC( $Terminal, $Bank, $CA, nc, 'ARQC',
                                         <~PAN, <'CDA', furtherData>, CVM, 
                                          <<$amount, country, currency, date, type, ~UN>, CDOL1>, 
                                          ATC, <Card_Eph_Pk, Terminal_Eph_Pk, S>, AC, IAD, 
                                          'Mastercard'>,
                                         'OnlinePIN', ~channelID
                   ) ▶₀ #i )
              case Terminal_Receives_AC_CDA
              solve( !KU( MAC(f(~MK, ~ATC),
                              <
                               <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                'TVR', 'OnlinePIN', 'HHMMSS'>, 
                               <'CDA', $furtherData>, ~ATC, 'IAD', 'ARQC'>)
                     ) @ #vk.32 )
                case Card_Responds_To_GenerateAC_CDA
                solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                       ) @ #vk.44 )
                  case Card_Responds_To_ReadRecord_NotDDA_case_1
                  solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                    'MAC_CARD_TO_READER'),
                                  <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                         ) @ #vk.55 )
                    case Card_Ext_Responds_To_Hello
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.68 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.56 )
                        case Card_Ext_Responds_To_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                    qed
                  next
                    case c_MAC
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.69 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.56 )
                        case Card_Ext_Responds_To_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_2
                  solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                    'MAC_CARD_TO_READER'),
                                  <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                         ) @ #vk.55 )
                    case Card_Ext_Responds_To_Hello
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.68 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.56 )
                        case Card_Ext_Responds_To_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                    qed
                  next
                    case c_MAC
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.69 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.56 )
                        case Card_Ext_Responds_To_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                    qed
                  qed
                next
                  case c_sign
                  solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                    'MAC_CARD_TO_READER'),
                                  <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                         ) @ #vk.54 )
                    case Card_Ext_Responds_To_Hello
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.66 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.55 )
                        case Card_Ext_Responds_To_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.80 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.80 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.82 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.81 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.81 )
                    qed
                  next
                    case c_MAC
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.67 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.55 )
                        case Card_Ext_Responds_To_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.82 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.82 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.84 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.83 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.83 )
                    qed
                  qed
                qed
              next
                case c_MAC
                solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                       ) @ #vk.47 )
                  case Card_Responds_To_ReadRecord_NotDDA_case_1
                  solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                    'MAC_CARD_TO_READER'),
                                  <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                         ) @ #vk.59 )
                    case Card_Ext_Responds_To_Hello
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.72 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                        case Card_Ext_Responds_To_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.91 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                    qed
                  next
                    case c_MAC
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.73 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                        case Card_Ext_Responds_To_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_2
                  solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                    'MAC_CARD_TO_READER'),
                                  <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                         ) @ #vk.59 )
                    case Card_Ext_Responds_To_Hello
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.72 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                        case Card_Ext_Responds_To_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.91 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                    qed
                  next
                    case c_MAC
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.73 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.60 )
                        case Card_Ext_Responds_To_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                    qed
                  qed
                next
                  case c_sign
                  solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                    'MAC_CARD_TO_READER'),
                                  <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                         ) @ #vk.58 )
                    case Card_Ext_Responds_To_Hello
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.70 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.59 )
                        case Card_Ext_Responds_To_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.85 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.85 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                    qed
                  next
                    case c_MAC
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.71 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^~Card_Eph_Sk ) @ #vk.59 )
                        case Card_Ext_Responds_To_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                    qed
                  qed
                qed
              qed
            qed
          next
            case c_sign
            solve( Terminal_Received_AC( $Terminal, $Bank, $CA, nc, 'ARQC',
                                         <~PAN, <'CDA', furtherData>, CVM, 
                                          <<$amount, country, currency, date, type, ~UN>, CDOL1>, 
                                          ATC, <Card_Eph_Pk, Terminal_Eph_Pk, S>, AC, IAD, 
                                          'Mastercard'>,
                                         'OnlinePIN', ~channelID
                   ) ▶₀ #i )
              case Terminal_Receives_AC_CDA
              solve( !KU( h(<
                             <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                              'TVR', 'OnlinePIN', 'HHMMSS'>, 
                             'ARQC', ATC, 
                             MAC(f(~MK, ATC),
                                 <
                                  <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                   'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                  <'CDA', $furtherData>, ATC, IAD>), 
                             IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.63 )
                case c_h
                solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                       ) @ #vk.49 )
                  case Card_Responds_To_ReadRecord_NotDDA_case_1
                  solve( !KU( MAC(f(~MK, ATC),
                                  <
                                   <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                    'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                   <'CDA', $furtherData>, ATC, IAD>)
                         ) @ #vk.37 )
                    case Card_Responds_To_GenerateAC_CDA
                    solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                    <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                           ) @ #vk.66 )
                      case Card_Ext_Responds_To_Hello
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.94 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.109 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.110 )
                      qed
                    next
                      case c_MAC
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.92 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( ~privkCard ) @ #vk.79 )
                          case Compromise_Card
                          by contradiction /* from formulas */
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.105 )
                      qed
                    qed
                  next
                    case c_MAC
                    solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                    <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                           ) @ #vk.66 )
                      case Card_Ext_Responds_To_Hello
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.93 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.104 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.104 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.106 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.105 )
                      qed
                    next
                      case c_MAC
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.91 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( ~privkCard ) @ #vk.77 )
                          case Compromise_Card
                          by contradiction /* from formulas */
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.100 )
                      qed
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_2
                  solve( !KU( MAC(f(~MK, ATC),
                                  <
                                   <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                    'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                   <'CDA', $furtherData>, ATC, IAD>)
                         ) @ #vk.37 )
                    case Card_Responds_To_GenerateAC_CDA
                    solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                    <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                           ) @ #vk.66 )
                      case Card_Ext_Responds_To_Hello
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.94 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.109 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.111 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.110 )
                      qed
                    next
                      case c_MAC
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.92 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( ~privkCard ) @ #vk.79 )
                          case Compromise_Card
                          by contradiction /* from formulas */
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.105 )
                      qed
                    qed
                  next
                    case c_MAC
                    solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                    <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                           ) @ #vk.66 )
                      case Card_Ext_Responds_To_Hello
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.93 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.104 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.104 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.106 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.105 )
                      qed
                    next
                      case c_MAC
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.91 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( ~privkCard ) @ #vk.77 )
                          case Compromise_Card
                          by contradiction /* from formulas */
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.100 )
                      qed
                    qed
                  qed
                next
                  case c_sign
                  solve( !KU( MAC(f(~MK, ATC),
                                  <
                                   <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                    'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                   <'CDA', $furtherData>, ATC, IAD>)
                         ) @ #vk.37 )
                    case Card_Responds_To_GenerateAC_CDA
                    solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                    <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                           ) @ #vk.65 )
                      case Card_Ext_Responds_To_Hello
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.92 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.103 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.103 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.105 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.104 )
                      qed
                    next
                      case c_MAC
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.90 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( ~privkCard ) @ #vk.77 )
                          case Compromise_Card
                          by contradiction /* from formulas */
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.99 )
                      qed
                    qed
                  next
                    case c_MAC
                    solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                    <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                           ) @ #vk.65 )
                      case Card_Ext_Responds_To_Hello
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.91 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                          case Card_Ext_Responds_To_Hello
                          by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.98 )
                        next
                          case Terminal_Ext_Sends_Hello
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.98 )
                        next
                          case c_exp
                          by solve( !KU( ~Card_Eph_Sk ) @ #vk.100 )
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.99 )
                      qed
                    next
                      case c_MAC
                      solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.89 )
                        case Terminal_Ext_Sends_Hello
                        solve( !KU( ~privkCard ) @ #vk.75 )
                          case Compromise_Card
                          by contradiction /* from formulas */
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        next
          case Compromise_Card
          solve( Terminal_Received_AC( $Terminal, $Bank, $CA, nc, 'ARQC',
                                       <~PAN, <'CDA', furtherData>, CVM, 
                                        <<$amount, country, currency, date, type, ~UN>, CDOL1>, 
                                        ATC, <Card_Eph_Pk, Terminal_Eph_Pk, S>, AC, IAD, 
                                        'Mastercard'>,
                                       'OnlinePIN', ~channelID
                 ) ▶₀ #i )
            case Terminal_Receives_AC_CDA
            by contradiction /* from formulas */
          qed
        qed
      next
        case c_sign
        solve( Terminal_Received_AC( $Terminal, $Bank, $CA, nc, 'ARQC',
                                     <~PAN, <'CDA', furtherData>, CVM, 
                                      <<$amount, country, currency, date, type, ~UN>, CDOL1>, ATC, 
                                      <Card_Eph_Pk, Terminal_Eph_Pk, S>, AC, IAD, 'Mastercard'>,
                                     'OnlinePIN', ~channelID
               ) ▶₀ #i )
          case Terminal_Receives_AC_CDA
          solve( !KU( sign(<'05', nc, 'ARQC', 
                            MAC(f(~MK, ATC),
                                <
                                 <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                  'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                 <'CDA', furtherData>, ATC, IAD>), 
                            h(<
                               <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                'TVR', 'OnlinePIN', 'HHMMSS'>, 
                               'ARQC', ATC, 
                               MAC(f(~MK, ATC),
                                   <
                                    <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                     'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                    <'CDA', furtherData>, ATC, IAD>), 
                               IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>), 
                            ~UN>,
                           x)
                 ) @ #vk.14 )
            case Card_Responds_To_GenerateAC_CDA
            solve( !KU( MAC(f(~MK, ~ATC),
                            <
                             <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                              'TVR', 'OnlinePIN', 'HHMMSS'>, 
                             <'CDA', $furtherData>, ~ATC, 'IAD', 'ARQC'>)
                   ) @ #vk.16 )
              case Card_Responds_To_GenerateAC_CDA
              solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                     ) @ #vk.42 )
                case Card_Responds_To_ReadRecord_NotDDA_case_1
                solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                  'MAC_CARD_TO_READER'),
                                <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                       ) @ #vk.55 )
                  case Card_Ext_Responds_To_Hello
                  solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.63 )
                    case Terminal_Ext_Sends_Hello
                    solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                      case Card_Ext_Responds_To_Hello
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.84 )
                    next
                      case Terminal_Ext_Sends_Hello
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.84 )
                    next
                      case c_exp
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                    qed
                  next
                    case c_exp
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.85 )
                  qed
                next
                  case c_MAC
                  solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.64 )
                    case Terminal_Ext_Sends_Hello
                    solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                      case Card_Ext_Responds_To_Hello
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                    next
                      case Terminal_Ext_Sends_Hello
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                    next
                      case c_exp
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                    qed
                  next
                    case c_exp
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                  qed
                qed
              next
                case Card_Responds_To_ReadRecord_NotDDA_case_2
                solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                  'MAC_CARD_TO_READER'),
                                <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                       ) @ #vk.55 )
                  case Card_Ext_Responds_To_Hello
                  solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.63 )
                    case Terminal_Ext_Sends_Hello
                    solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                      case Card_Ext_Responds_To_Hello
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.84 )
                    next
                      case Terminal_Ext_Sends_Hello
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.84 )
                    next
                      case c_exp
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                    qed
                  next
                    case c_exp
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.85 )
                  qed
                next
                  case c_MAC
                  solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.64 )
                    case Terminal_Ext_Sends_Hello
                    solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                      case Card_Ext_Responds_To_Hello
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                    next
                      case Terminal_Ext_Sends_Hello
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                    next
                      case c_exp
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                    qed
                  next
                    case c_exp
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                  qed
                qed
              next
                case c_sign
                solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                  'MAC_CARD_TO_READER'),
                                <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                       ) @ #vk.54 )
                  case Card_Ext_Responds_To_Hello
                  solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.62 )
                    case Terminal_Ext_Sends_Hello
                    solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                      case Card_Ext_Responds_To_Hello
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.78 )
                    next
                      case Terminal_Ext_Sends_Hello
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.78 )
                    next
                      case c_exp
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.80 )
                    qed
                  next
                    case c_exp
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.79 )
                  qed
                next
                  case c_MAC
                  solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.63 )
                    case Terminal_Ext_Sends_Hello
                    solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                      case Card_Ext_Responds_To_Hello
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.80 )
                    next
                      case Terminal_Ext_Sends_Hello
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.80 )
                    next
                      case c_exp
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.82 )
                    qed
                  next
                    case c_exp
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.81 )
                  qed
                qed
              qed
            next
              case c_MAC
              solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                     ) @ #vk.44 )
                case Card_Responds_To_ReadRecord_NotDDA_case_1
                solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                  'MAC_CARD_TO_READER'),
                                <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                       ) @ #vk.59 )
                  case Card_Ext_Responds_To_Hello
                  solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.67 )
                    case Terminal_Ext_Sends_Hello
                    solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                      case Card_Ext_Responds_To_Hello
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                    next
                      case Terminal_Ext_Sends_Hello
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                    next
                      case c_exp
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                    qed
                  next
                    case c_exp
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                  qed
                next
                  case c_MAC
                  solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.68 )
                    case Terminal_Ext_Sends_Hello
                    solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                      case Card_Ext_Responds_To_Hello
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.91 )
                    next
                      case Terminal_Ext_Sends_Hello
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                    next
                      case c_exp
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                    qed
                  next
                    case c_exp
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                  qed
                qed
              next
                case Card_Responds_To_ReadRecord_NotDDA_case_2
                solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                  'MAC_CARD_TO_READER'),
                                <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                       ) @ #vk.59 )
                  case Card_Ext_Responds_To_Hello
                  solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.67 )
                    case Terminal_Ext_Sends_Hello
                    solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                      case Card_Ext_Responds_To_Hello
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                    next
                      case Terminal_Ext_Sends_Hello
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                    next
                      case c_exp
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                    qed
                  next
                    case c_exp
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                  qed
                next
                  case c_MAC
                  solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.68 )
                    case Terminal_Ext_Sends_Hello
                    solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                      case Card_Ext_Responds_To_Hello
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.91 )
                    next
                      case Terminal_Ext_Sends_Hello
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                    next
                      case c_exp
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                    qed
                  next
                    case c_exp
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                  qed
                qed
              next
                case c_sign
                solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                  'MAC_CARD_TO_READER'),
                                <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                       ) @ #vk.58 )
                  case Card_Ext_Responds_To_Hello
                  solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.66 )
                    case Terminal_Ext_Sends_Hello
                    solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                      case Card_Ext_Responds_To_Hello
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.83 )
                    next
                      case Terminal_Ext_Sends_Hello
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.83 )
                    next
                      case c_exp
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.85 )
                    qed
                  next
                    case c_exp
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.84 )
                  qed
                next
                  case c_MAC
                  solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.67 )
                    case Terminal_Ext_Sends_Hello
                    solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                      case Card_Ext_Responds_To_Hello
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.85 )
                    next
                      case Terminal_Ext_Sends_Hello
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.85 )
                    next
                      case c_exp
                      by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                    qed
                  next
                    case c_exp
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                  qed
                qed
              qed
            qed
          next
            case c_sign
            solve( !KU( h(<
                           <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                            'TVR', 'OnlinePIN', 'HHMMSS'>, 
                           'ARQC', ATC, 
                           MAC(f(~MK, ATC),
                               <
                                <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                 'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                <'CDA', furtherData>, ATC, IAD>), 
                           IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                   ) @ #vk.59 )
              case c_h
              solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                     ) @ #vk.45 )
                case Card_Responds_To_ReadRecord_NotDDA_case_1
                solve( !KU( MAC(f(~MK, ATC),
                                <
                                 <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                  'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                 <'CDA', furtherData>, ATC, IAD>)
                       ) @ #vk.25 )
                  case Card_Responds_To_GenerateAC_CDA
                  solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                  <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                         ) @ #vk.66 )
                    case Card_Ext_Responds_To_Hello
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.88 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                        case Card_Ext_Responds_To_Hello
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.107 )
                      next
                        case Terminal_Ext_Sends_Hello
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.107 )
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.108 )
                    qed
                  next
                    case c_MAC
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.87 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( ~PAN ) @ #vk.45 )
                        case Card_Responds_To_ReadRecord_NotDDA_case_1
                        solve( !KU( ~privkBank ) @ #vk.73 )
                          case Compromise_Bank
                          by contradiction /* from formulas */
                        qed
                      next
                        case Card_Responds_To_ReadRecord_NotDDA_case_2
                        solve( !KU( ~privkBank ) @ #vk.73 )
                          case Compromise_Bank
                          by contradiction /* from formulas */
                        qed
                      next
                        case Compromise_Card
                        by contradiction /* from formulas */
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.103 )
                    qed
                  qed
                next
                  case c_MAC
                  solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                  <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                         ) @ #vk.67 )
                    case Card_Ext_Responds_To_Hello
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.88 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                        case Card_Ext_Responds_To_Hello
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.103 )
                      next
                        case Terminal_Ext_Sends_Hello
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.103 )
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.105 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.104 )
                    qed
                  next
                    case c_MAC
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.87 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( ~PAN ) @ #vk.41 )
                        case Card_Responds_To_ReadRecord_NotDDA_case_1
                        solve( !KU( ~privkBank ) @ #vk.74 )
                          case Compromise_Bank
                          by contradiction /* from formulas */
                        qed
                      next
                        case Card_Responds_To_ReadRecord_NotDDA_case_2
                        solve( !KU( ~privkBank ) @ #vk.73 )
                          case Compromise_Bank
                          by contradiction /* from formulas */
                        qed
                      next
                        case Card_Responds_To_ReadRecord_NotDDA_case_3
                        solve( !KU( ~privkBank ) @ #vk.73 )
                          case Compromise_Bank
                          by contradiction /* from formulas */
                        qed
                      next
                        case Compromise_Card
                        by contradiction /* from formulas */
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.99 )
                    qed
                  qed
                qed
              next
                case Card_Responds_To_ReadRecord_NotDDA_case_2
                solve( !KU( MAC(f(~MK, ATC),
                                <
                                 <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                  'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                 <'CDA', furtherData>, ATC, IAD>)
                       ) @ #vk.25 )
                  case Card_Responds_To_GenerateAC_CDA
                  solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                  <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                         ) @ #vk.66 )
                    case Card_Ext_Responds_To_Hello
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.88 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                        case Card_Ext_Responds_To_Hello
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.107 )
                      next
                        case Terminal_Ext_Sends_Hello
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.107 )
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.109 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.108 )
                    qed
                  next
                    case c_MAC
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.87 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( ~PAN ) @ #vk.45 )
                        case Card_Responds_To_ReadRecord_NotDDA_case_1
                        solve( !KU( ~privkBank ) @ #vk.73 )
                          case Compromise_Bank
                          by contradiction /* from formulas */
                        qed
                      next
                        case Card_Responds_To_ReadRecord_NotDDA_case_2
                        solve( !KU( ~privkBank ) @ #vk.73 )
                          case Compromise_Bank
                          by contradiction /* from formulas */
                        qed
                      next
                        case Compromise_Card
                        by contradiction /* from formulas */
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.103 )
                    qed
                  qed
                next
                  case c_MAC
                  solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                  <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                         ) @ #vk.67 )
                    case Card_Ext_Responds_To_Hello
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.88 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                        case Card_Ext_Responds_To_Hello
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.103 )
                      next
                        case Terminal_Ext_Sends_Hello
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.103 )
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.105 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.104 )
                    qed
                  next
                    case c_MAC
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.87 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( ~PAN ) @ #vk.41 )
                        case Card_Responds_To_ReadRecord_NotDDA_case_1
                        solve( !KU( ~privkBank ) @ #vk.73 )
                          case Compromise_Bank
                          by contradiction /* from formulas */
                        qed
                      next
                        case Card_Responds_To_ReadRecord_NotDDA_case_2
                        solve( !KU( ~privkBank ) @ #vk.73 )
                          case Compromise_Bank
                          by contradiction /* from formulas */
                        qed
                      next
                        case Card_Responds_To_ReadRecord_NotDDA_case_3
                        solve( !KU( ~privkBank ) @ #vk.73 )
                          case Compromise_Bank
                          by contradiction /* from formulas */
                        qed
                      next
                        case Compromise_Card
                        by contradiction /* from formulas */
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.99 )
                    qed
                  qed
                qed
              next
                case c_sign
                solve( !KU( MAC(f(~MK, ATC),
                                <
                                 <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                                  'TVR', 'OnlinePIN', 'HHMMSS'>, 
                                 <'CDA', furtherData>, ATC, IAD>)
                       ) @ #vk.25 )
                  case Card_Responds_To_GenerateAC_CDA
                  solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                  <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                         ) @ #vk.65 )
                    case Card_Ext_Responds_To_Hello
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.87 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                        case Card_Ext_Responds_To_Hello
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.101 )
                      next
                        case Terminal_Ext_Sends_Hello
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.101 )
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.103 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                    qed
                  next
                    case c_MAC
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.86 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( ~PAN ) @ #vk.45 )
                        case Card_Responds_To_ReadRecord_NotDDA_case_1
                        solve( !KU( ~privkBank ) @ #vk.72 )
                          case Compromise_Bank
                          by contradiction /* from formulas */
                        qed
                      next
                        case Card_Responds_To_ReadRecord_NotDDA_case_2
                        solve( !KU( ~privkBank ) @ #vk.72 )
                          case Compromise_Bank
                          by contradiction /* from formulas */
                        qed
                      next
                        case Compromise_Card
                        by contradiction /* from formulas */
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.97 )
                    qed
                  qed
                next
                  case c_MAC
                  solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                                  <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                         ) @ #vk.66 )
                    case Card_Ext_Responds_To_Hello
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.86 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                        case Card_Ext_Responds_To_Hello
                        by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                      next
                        case Terminal_Ext_Sends_Hello
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                      next
                        case c_exp
                        by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.96 )
                    qed
                  next
                    case c_MAC
                    solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.85 )
                      case Terminal_Ext_Sends_Hello
                      solve( !KU( ~PAN ) @ #vk.41 )
                        case Card_Responds_To_ReadRecord_NotDDA_case_1
                        solve( !KU( ~privkBank ) @ #vk.72 )
                          case Compromise_Bank
                          by contradiction /* from formulas */
                        qed
                      next
                        case Card_Responds_To_ReadRecord_NotDDA_case_2
                        solve( !KU( ~privkBank ) @ #vk.72 )
                          case Compromise_Bank
                          by contradiction /* from formulas */
                        qed
                      next
                        case Card_Responds_To_ReadRecord_NotDDA_case_3
                        solve( !KU( ~privkBank ) @ #vk.72 )
                          case Compromise_Bank
                          by contradiction /* from formulas */
                        qed
                      next
                        case Compromise_Card
                        by contradiction /* from formulas */
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
next
  case Terminal_Commits_TC
  solve( Terminal_Received_AC( $Terminal, $Bank, $CA, nc, 'TC',
                               <~PAN, <'CDA', furtherData>, CVM, 
                                <<$amount, country, currency, date, type, ~UN>, CDOL1>, ATC, 
                                <Card_Eph_Pk, Terminal_Eph_Pk, S>, AC, IAD, 'Mastercard'>,
                               'OnlinePIN', ~channelID
         ) ▶₀ #i )
    case Terminal_Receives_AC_CDA_case_1
    solve( !KU( pk(x) ) @ #vk.29 )
      case Card_Responds_To_ReadRecord_NotDDA_case_1
      solve( !KU( sign(<'05', nc, 'TC', AC, 
                        h(<
                           <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                            'TVR', 'NoPIN', 'HHMMSS'>, 
                           'TC', ATC, AC, IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>), 
                        ~UN>,
                       x)
             ) @ #vk.10 )
        case Card_Responds_To_GenerateAC_CDA
        solve( !KU( MAC(f(~MK, ~ATC),
                        <
                         <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                          'TVR', 'NoPIN', 'HHMMSS'>, 
                         <'CDA', $furtherData.1>, ~ATC, 'IAD', 'TC'>)
               ) @ #vk.10 )
          case Card_Responds_To_GenerateAC_CDA
          solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA.1)
                 ) @ #vk.34 )
            case Card_Responds_To_ReadRecord_NotDDA
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.45 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.53 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.72 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.73 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.52 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.71 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.85 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.85 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.72 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                qed
              qed
            qed
          next
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.45 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.53 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.72 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.73 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.91 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.52 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.71 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.72 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                qed
              qed
            qed
          qed
        next
          case c_MAC
          solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA.1)
                 ) @ #vk.35 )
            case Card_Responds_To_ReadRecord_NotDDA
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.48 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.76 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.77 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.96 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.76 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.77 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.96 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                qed
              qed
            qed
          next
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.48 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.76 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.77 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.96 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.76 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.77 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.96 )
                qed
              qed
            qed
          qed
        qed
      next
        case c_sign
        solve( !KU( h(<
                       <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                        'TVR', 'NoPIN', 'HHMMSS'>, 
                       'TC', ATC, AC, IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
               ) @ #vk.65 )
          case c_h
          solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA.1)
                 ) @ #vk.41 )
            case Card_Responds_To_ReadRecord_NotDDA
            solve( !KU( sign(<'04', ~PAN, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                              furtherData>,
                             ~privkBank)
                   ) @ #vk.52 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.61 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.94 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.101 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.101 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.103 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.92 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.39 )
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.76 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCard ) @ #vk.75 )
                        case Compromise_Card
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.76 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCard ) @ #vk.75 )
                        case Compromise_Card
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card
                    by contradiction /* from formulas */
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.97 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.59 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.91 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.97 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.99 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.98 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.89 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.39 )
                    case Card_Responds_To_GenerateAC_CDA_case_1
                    solve( !KU( ~UN ) @ #vk.77 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.97 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_GenerateAC_CDA_case_2
                    solve( !KU( ~UN ) @ #vk.77 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.97 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.76 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.93 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.76 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.93 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_3
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.92 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_4
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.92 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_5
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.92 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank_Card_ShK
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_CA
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card_case_1
                    by contradiction /* from formulas */
                  next
                    case Compromise_Card_case_2
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Generate_ATC
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_1
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_2
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case fresh
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              qed
            qed
          next
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                              furtherData>,
                             ~privkBank)
                   ) @ #vk.52 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.61 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.94 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.102 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.104 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.103 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.92 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.39 )
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.76 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.93 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.76 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.93 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card
                    by contradiction /* from formulas */
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.98 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.59 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.91 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.98 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.98 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.100 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.99 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.89 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.38 )
                    case Card_Responds_To_GenerateAC_CDA_case_1
                    solve( !KU( ~UN ) @ #vk.77 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.97 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_GenerateAC_CDA_case_2
                    solve( !KU( ~UN ) @ #vk.77 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.97 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.76 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.93 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.76 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.93 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_3
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.92 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_4
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.92 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_5
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.92 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank_Card_ShK
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_CA
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card_case_1
                    by contradiction /* from formulas */
                  next
                    case Compromise_Card_case_2
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Generate_ATC
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_1
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_2
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case fresh
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                qed
              qed
            qed
          qed
        qed
      qed
    next
      case Card_Responds_To_ReadRecord_NotDDA_case_2
      solve( !KU( sign(<'05', nc, 'TC', AC, 
                        h(<
                           <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                            'TVR', 'NoPIN', 'HHMMSS'>, 
                           'TC', ATC, AC, IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>), 
                        ~UN>,
                       x)
             ) @ #vk.10 )
        case Card_Responds_To_GenerateAC_CDA
        solve( !KU( MAC(f(~MK, ~ATC),
                        <
                         <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                          'TVR', 'NoPIN', 'HHMMSS'>, 
                         <'CDA', $furtherData.1>, ~ATC, 'IAD', 'TC'>)
               ) @ #vk.10 )
          case Card_Responds_To_GenerateAC_CDA
          solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA.1)
                 ) @ #vk.34 )
            case Card_Responds_To_ReadRecord_NotDDA
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.45 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.53 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.72 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.73 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.52 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.71 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.85 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.85 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.72 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                qed
              qed
            qed
          next
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.45 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.53 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.72 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.73 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.91 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.52 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.71 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.72 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                qed
              qed
            qed
          qed
        next
          case c_MAC
          solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA.1)
                 ) @ #vk.35 )
            case Card_Responds_To_ReadRecord_NotDDA
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.48 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.76 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.77 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.96 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.76 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.77 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.96 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                qed
              qed
            qed
          next
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.48 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.76 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.77 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.96 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.76 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.77 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.96 )
                qed
              qed
            qed
          qed
        qed
      next
        case c_sign
        solve( !KU( h(<
                       <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                        'TVR', 'NoPIN', 'HHMMSS'>, 
                       'TC', ATC, AC, IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
               ) @ #vk.65 )
          case c_h
          solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA.1)
                 ) @ #vk.41 )
            case Card_Responds_To_ReadRecord_NotDDA
            solve( !KU( sign(<'04', ~PAN, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                              furtherData>,
                             ~privkBank)
                   ) @ #vk.52 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.61 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.94 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.101 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.101 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.103 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.92 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.39 )
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.76 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCard ) @ #vk.75 )
                        case Compromise_Card
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.76 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCard ) @ #vk.75 )
                        case Compromise_Card
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card
                    by contradiction /* from formulas */
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.97 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.59 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.91 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.97 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.99 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.98 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.89 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.39 )
                    case Card_Responds_To_GenerateAC_CDA_case_1
                    solve( !KU( ~UN ) @ #vk.77 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.97 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_GenerateAC_CDA_case_2
                    solve( !KU( ~UN ) @ #vk.77 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.97 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.92 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.92 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_3
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.92 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_4
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.92 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_5
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.92 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank_Card_ShK
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_CA
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card_case_1
                    by contradiction /* from formulas */
                  next
                    case Compromise_Card_case_2
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Generate_ATC
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_1
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_2
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case fresh
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              qed
            qed
          next
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                              furtherData>,
                             ~privkBank)
                   ) @ #vk.52 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.61 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.94 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.102 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.104 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.103 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.92 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.39 )
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.76 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.93 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.76 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.93 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card
                    by contradiction /* from formulas */
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.98 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.59 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.91 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.98 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.98 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.100 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.99 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.89 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.38 )
                    case Card_Responds_To_GenerateAC_CDA_case_1
                    solve( !KU( ~UN ) @ #vk.77 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.97 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_GenerateAC_CDA_case_2
                    solve( !KU( ~UN ) @ #vk.77 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.97 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.92 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.92 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_3
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.92 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_4
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.92 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_5
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.92 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank_Card_ShK
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_CA
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card_case_1
                    by contradiction /* from formulas */
                  next
                    case Compromise_Card_case_2
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Generate_ATC
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_1
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_2
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case fresh
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                qed
              qed
            qed
          qed
        qed
      qed
    next
      case Card_Responds_To_ReadRecord_NotDDA_case_3
      solve( !KU( sign(<'05', nc, 'TC', AC, 
                        h(<
                           <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                            'TVR', 'NoPIN', 'HHMMSS'>, 
                           'TC', ATC, AC, IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>), 
                        ~UN>,
                       x)
             ) @ #vk.10 )
        case Card_Responds_To_GenerateAC_CDA
        solve( !KU( MAC(f(~MK, ~ATC),
                        <
                         <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                          'TVR', 'NoPIN', 'HHMMSS'>, 
                         <'CDA', $furtherData.1>, ~ATC, 'IAD', 'TC'>)
               ) @ #vk.10 )
          case Card_Responds_To_GenerateAC_CDA
          solve( !KU( sign(<'02', $Bank, pk(~privkCard.1), $CA>, ~privkCA.1)
                 ) @ #vk.34 )
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkCard.1)
                   ) @ #vk.45 )
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.52 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.71 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.72 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                qed
              qed
            qed
          qed
        next
          case c_MAC
          solve( !KU( sign(<'02', $Bank, pk(~privkCard.1), $CA>, ~privkCA.1)
                 ) @ #vk.35 )
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkCard.1)
                   ) @ #vk.48 )
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.76 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.77 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.96 )
                qed
              qed
            qed
          qed
        qed
      next
        case c_sign
        solve( !KU( h(<
                       <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                        'TVR', 'NoPIN', 'HHMMSS'>, 
                       'TC', ATC, AC, IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
               ) @ #vk.65 )
          case c_h
          solve( !KU( sign(<'02', $Bank, pk(~privkCard), $CA>, ~privkCA.1)
                 ) @ #vk.41 )
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                              furtherData>,
                             ~privkCard)
                   ) @ #vk.52 )
              case c_sign
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.59 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.91 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.98 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.98 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.100 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.99 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.89 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.38 )
                    case Card_Responds_To_GenerateAC_CDA_case_1
                    solve( !KU( ~UN ) @ #vk.77 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.97 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_GenerateAC_CDA_case_2
                    solve( !KU( ~UN ) @ #vk.77 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.97 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.92 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.92 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_3
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.92 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_4
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.92 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_5
                    solve( !KU( ~UN ) @ #vk.75 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.92 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank_Card_ShK
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_CA
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card_case_1
                    by contradiction /* from formulas */
                  next
                    case Compromise_Card_case_2
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Generate_ATC
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_1
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_2
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case fresh
                    solve( !KU( ~UN ) @ #vk.73 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                qed
              qed
            qed
          qed
        qed
      qed
    next
      case Create_Bank
      solve( !KU( sign(<'05', nc, 'TC', AC, 
                        h(<
                           <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                            'TVR', 'NoPIN', 'HHMMSS'>, 
                           'TC', ATC, AC, IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>), 
                        ~UN>,
                       x)
             ) @ #vk.10 )
        case Card_Responds_To_GenerateAC_CDA
        solve( !KU( MAC(f(~MK, ~ATC),
                        <
                         <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                          'TVR', 'NoPIN', 'HHMMSS'>, 
                         <'CDA', $furtherData.1>, ~ATC, 'IAD', 'TC'>)
               ) @ #vk.10 )
          case Card_Responds_To_GenerateAC_CDA
          solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                 ) @ #vk.34 )
            case Card_Responds_To_ReadRecord_NotDDA_case_1
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.45 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.53 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.63 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.64 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.52 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.63 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.85 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.85 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.64 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                qed
              qed
            qed
          next
            case Card_Responds_To_ReadRecord_NotDDA_case_2
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.45 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.53 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.63 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.64 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.52 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.63 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.85 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.85 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.64 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                qed
              qed
            qed
          next
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.45 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.52 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.62 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.81 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.81 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.83 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.82 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.63 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.83 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.83 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.85 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.84 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.51 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.62 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.79 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.79 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.81 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.80 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.63 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.81 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.81 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.83 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.82 )
                qed
              qed
            qed
          qed
        next
          case c_MAC
          solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                 ) @ #vk.35 )
            case Card_Responds_To_ReadRecord_NotDDA_case_1
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.48 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.67 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.68 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.96 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.68 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.69 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.96 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                qed
              qed
            qed
          next
            case Card_Responds_To_ReadRecord_NotDDA_case_2
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.48 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.67 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.68 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.96 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.68 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.69 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.96 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                qed
              qed
            qed
          next
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.48 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.55 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.66 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.67 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.55 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.67 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.68 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                qed
              qed
            qed
          qed
        qed
      next
        case c_sign
        solve( !KU( h(<
                       <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                        'TVR', 'NoPIN', 'HHMMSS'>, 
                       'TC', ATC, AC, IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
               ) @ #vk.55 )
          case c_h
          solve( !KU( sign(<'02', $Bank, pk(~privkBank), $CA>, ~privkCA)
                 ) @ #vk.41 )
            case Card_Responds_To_ReadRecord_NotDDA_case_1
            solve( !KU( sign(<'04', ~PAN, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                              furtherData>,
                             ~privkBank)
                   ) @ #vk.52 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.61 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.84 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.101 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.101 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.103 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.83 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.39 )
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCard ) @ #vk.66 )
                        case Compromise_Card
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCard ) @ #vk.66 )
                        case Compromise_Card
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card
                    by contradiction /* from formulas */
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.97 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.59 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.82 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.97 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.99 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.98 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.81 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.38 )
                    case Card_Responds_To_GenerateAC_CDA_case_1
                    solve( !KU( ~UN ) @ #vk.68 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.97 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_GenerateAC_CDA_case_2
                    solve( !KU( ~UN ) @ #vk.68 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.97 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.93 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.93 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_3
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.92 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_4
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.92 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_5
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.92 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank_Card_ShK
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_CA
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card_case_1
                    by contradiction /* from formulas */
                  next
                    case Compromise_Card_case_2
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Generate_ATC
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_1
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_2
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case fresh
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              qed
            qed
          next
            case Card_Responds_To_ReadRecord_NotDDA_case_2
            solve( !KU( sign(<'04', ~PAN, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                              furtherData>,
                             ~privkBank)
                   ) @ #vk.52 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.61 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.84 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.101 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.101 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.103 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.83 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.39 )
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCard ) @ #vk.66 )
                        case Compromise_Card
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCard ) @ #vk.66 )
                        case Compromise_Card
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card
                    by contradiction /* from formulas */
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.97 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.59 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.82 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.97 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.99 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.98 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.81 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.38 )
                    case Card_Responds_To_GenerateAC_CDA_case_1
                    solve( !KU( ~UN ) @ #vk.68 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.97 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_GenerateAC_CDA_case_2
                    solve( !KU( ~UN ) @ #vk.68 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.97 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.92 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.92 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_3
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.92 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_4
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.92 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_5
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.92 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank_Card_ShK
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_CA
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card_case_1
                    by contradiction /* from formulas */
                  next
                    case Compromise_Card_case_2
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Generate_ATC
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_1
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_2
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case fresh
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.90 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              qed
            qed
          next
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                              furtherData>,
                             ~privkBank)
                   ) @ #vk.52 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.60 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.83 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.96 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.82 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.39 )
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.83 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.83 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card
                    by contradiction /* from formulas */
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.91 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.58 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.80 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.79 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.38 )
                    case Card_Responds_To_GenerateAC_CDA_case_1
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.87 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_GenerateAC_CDA_case_2
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.87 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.82 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.82 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_3
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.82 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_4
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.82 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_5
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.82 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank
                    solve( !KU( ~UN ) @ #vk.63 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.80 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank_Card_ShK
                    solve( !KU( ~UN ) @ #vk.63 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.80 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_CA
                    solve( !KU( ~UN ) @ #vk.63 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.80 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card_case_1
                    by contradiction /* from formulas */
                  next
                    case Compromise_Card_case_2
                    solve( !KU( ~UN ) @ #vk.63 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.80 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Generate_ATC
                    solve( !KU( ~UN ) @ #vk.63 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.80 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_1
                    solve( !KU( ~UN ) @ #vk.63 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.80 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_2
                    solve( !KU( ~UN ) @ #vk.63 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.80 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case fresh
                    solve( !KU( ~UN ) @ #vk.63 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.80 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.84 )
                qed
              qed
            qed
          qed
        qed
      qed
    next
      case Create_CA
      solve( !KU( sign(<'05', nc, 'TC', AC, 
                        h(<
                           <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                            'TVR', 'NoPIN', 'HHMMSS'>, 
                           'TC', ATC, AC, IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>), 
                        ~UN>,
                       x)
             ) @ #vk.10 )
        case Card_Responds_To_GenerateAC_CDA
        solve( !KU( MAC(f(~MK, ~ATC),
                        <
                         <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                          'TVR', 'NoPIN', 'HHMMSS'>, 
                         <'CDA', $furtherData.1>, ~ATC, 'IAD', 'TC'>)
               ) @ #vk.10 )
          case Card_Responds_To_GenerateAC_CDA
          solve( !KU( sign(<'02', $Bank, pk(~privkCA), $CA>, ~privkCA.1)
                 ) @ #vk.34 )
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkCA)
                   ) @ #vk.45 )
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.51 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.62 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.79 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.79 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.81 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.80 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.63 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.81 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.81 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.83 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.82 )
                qed
              qed
            qed
          qed
        next
          case c_MAC
          solve( !KU( sign(<'02', $Bank, pk(~privkCA), $CA>, ~privkCA.1)
                 ) @ #vk.35 )
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkCA)
                   ) @ #vk.48 )
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.55 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.67 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.68 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                qed
              qed
            qed
          qed
        qed
      next
        case c_sign
        solve( !KU( h(<
                       <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                        'TVR', 'NoPIN', 'HHMMSS'>, 
                       'TC', ATC, AC, IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
               ) @ #vk.55 )
          case c_h
          solve( !KU( sign(<'02', $Bank, pk(~privkCA), $CA>, ~privkCA.1)
                 ) @ #vk.41 )
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                              furtherData>,
                             ~privkCA)
                   ) @ #vk.52 )
              case c_sign
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.58 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.80 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.79 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.38 )
                    case Card_Responds_To_GenerateAC_CDA_case_1
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.87 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_GenerateAC_CDA_case_2
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.87 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.82 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.82 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_3
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.82 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_4
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.82 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_5
                    solve( !KU( ~UN ) @ #vk.65 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.2 ) @ #vk.82 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank
                    solve( !KU( ~UN ) @ #vk.63 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.80 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank_Card_ShK
                    solve( !KU( ~UN ) @ #vk.63 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.80 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_CA
                    solve( !KU( ~UN ) @ #vk.63 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.80 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card_case_1
                    by contradiction /* from formulas */
                  next
                    case Compromise_Card_case_2
                    solve( !KU( ~UN ) @ #vk.63 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.80 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Generate_ATC
                    solve( !KU( ~UN ) @ #vk.63 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.80 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_1
                    solve( !KU( ~UN ) @ #vk.63 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.80 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_2
                    solve( !KU( ~UN ) @ #vk.63 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.80 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case fresh
                    solve( !KU( ~UN ) @ #vk.63 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.80 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.84 )
                qed
              qed
            qed
          qed
        qed
      qed
    next
      case Set_Records_NotSDA
      solve( !KU( sign(<'05', nc, 'TC', AC, 
                        h(<
                           <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                            'TVR', 'NoPIN', 'HHMMSS'>, 
                           'TC', ATC, AC, IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>), 
                        ~UN>,
                       x)
             ) @ #vk.10 )
        case Card_Responds_To_GenerateAC_CDA
        solve( !KU( MAC(f(~MK, ~ATC),
                        <
                         <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                          'TVR', 'NoPIN', 'HHMMSS'>, 
                         <'CDA', $furtherData.1>, ~ATC, 'IAD', 'TC'>)
               ) @ #vk.10 )
          case Card_Responds_To_GenerateAC_CDA
          solve( !KU( sign(<'02', $Bank, pk(~privkCard.1), $CA>, ~privkCA)
                 ) @ #vk.34 )
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkCard.1)
                   ) @ #vk.45 )
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.51 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.65 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.82 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.82 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.84 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.83 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.66 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.84 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.84 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.85 )
                qed
              qed
            qed
          qed
        next
          case c_MAC
          solve( !KU( sign(<'02', $Bank, pk(~privkCard.1), $CA>, ~privkCA)
                 ) @ #vk.35 )
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkCard.1)
                   ) @ #vk.48 )
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.55 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.70 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.71 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.91 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                qed
              qed
            qed
          qed
        qed
      next
        case c_sign
        solve( !KU( h(<
                       <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                        'TVR', 'NoPIN', 'HHMMSS'>, 
                       'TC', ATC, AC, IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
               ) @ #vk.58 )
          case c_h
          solve( !KU( sign(<'02', $Bank, pk(~privkCard), $CA>, ~privkCA)
                 ) @ #vk.41 )
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                              furtherData>,
                             ~privkCard)
                   ) @ #vk.52 )
              case c_sign
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.58 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.83 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.82 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.38 )
                    case Card_Responds_To_GenerateAC_CDA_case_1
                    solve( !KU( ~UN ) @ #vk.70 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_GenerateAC_CDA_case_2
                    solve( !KU( ~UN ) @ #vk.70 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.90 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.68 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.85 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.68 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.85 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_3
                    solve( !KU( ~UN ) @ #vk.68 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.85 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_4
                    solve( !KU( ~UN ) @ #vk.68 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.85 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_5
                    solve( !KU( ~UN ) @ #vk.68 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.85 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.83 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank_Card_ShK
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.83 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_CA
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.83 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card_case_1
                    by contradiction /* from formulas */
                  next
                    case Compromise_Card_case_2
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.83 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Generate_ATC
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.83 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_1
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.83 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_2
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.83 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case fresh
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.83 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                qed
              qed
            qed
          qed
        qed
      qed
    next
      case c_pk
      solve( !KU( sign(<'05', nc, 'TC', AC, 
                        h(<
                           <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                            'TVR', 'NoPIN', 'HHMMSS'>, 
                           'TC', ATC, AC, IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>), 
                        ~UN>,
                       x)
             ) @ #vk.10 )
        case Card_Responds_To_GenerateAC_CDA
        solve( !KU( MAC(f(~MK, ~ATC),
                        <
                         <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                          'TVR', 'NoPIN', 'HHMMSS'>, 
                         <'CDA', $furtherData.1>, ~ATC, 'IAD', 'TC'>)
               ) @ #vk.10 )
          case Card_Responds_To_GenerateAC_CDA
          solve( !KU( sign(<'02', $Bank, pk(x), $CA>, ~privkCA) ) @ #vk.34 )
            case Card_Responds_To_ReadRecord_NotDDA_case_1
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.45 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.53 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.64 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.65 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.91 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.52 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.64 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.85 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.85 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.65 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                qed
              qed
            qed
          next
            case Card_Responds_To_ReadRecord_NotDDA_case_2
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.45 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.53 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.64 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.65 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.91 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.52 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.64 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.85 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.85 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.65 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                qed
              qed
            qed
          next
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             x)
                   ) @ #vk.45 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.52 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.63 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.82 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.82 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.84 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.83 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.64 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.84 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.84 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.85 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.51 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.63 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.79 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.79 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.81 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.80 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.64 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.81 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.81 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.83 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.82 )
                qed
              qed
            qed
          qed
        next
          case c_MAC
          solve( !KU( sign(<'02', $Bank, pk(x), $CA>, ~privkCA) ) @ #vk.35 )
            case Card_Responds_To_ReadRecord_NotDDA_case_1
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.48 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.68 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.69 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.96 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.69 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.70 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.96 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                qed
              qed
            qed
          next
            case Card_Responds_To_ReadRecord_NotDDA_case_2
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             ~privkBank)
                   ) @ #vk.48 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.68 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.69 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.96 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.56 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.69 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.70 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.94 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.96 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                qed
              qed
            qed
          next
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                              'CDA', furtherData>,
                             x)
                   ) @ #vk.48 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.55 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.67 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.68 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                                'MAC_CARD_TO_READER'),
                              <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.55 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.68 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.69 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                qed
              qed
            qed
          qed
        qed
      next
        case c_sign
        solve( !KU( h(<
                       <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                        'TVR', 'NoPIN', 'HHMMSS'>, 
                       'TC', ATC, AC, IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
               ) @ #vk.56 )
          case c_h
          solve( !KU( sign(<'02', $Bank, pk(x.1), $CA>, ~privkCA)
                 ) @ #vk.41 )
            case Card_Responds_To_ReadRecord_NotDDA_case_1
            solve( !KU( sign(<'04', ~PAN, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                              furtherData>,
                             ~privkBank)
                   ) @ #vk.52 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.61 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.85 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.102 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.104 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.103 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.84 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.39 )
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.68 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.66 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.68 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.66 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card
                    by contradiction /* from formulas */
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.98 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.59 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.83 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.97 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.99 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.98 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.82 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.38 )
                    case Card_Responds_To_GenerateAC_CDA_case_1
                    solve( !KU( ~UN ) @ #vk.69 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.68 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_GenerateAC_CDA_case_2
                    solve( !KU( ~UN ) @ #vk.69 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.68 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.65 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.65 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_3
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.65 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_4
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.65 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_5
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.65 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.64 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank_Card_ShK
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.64 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_CA
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.64 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card_case_1
                    by contradiction /* from formulas */
                  next
                    case Compromise_Card_case_2
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.64 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Generate_ATC
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.64 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_1
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.64 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_2
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.64 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case fresh
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.64 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              qed
            qed
          next
            case Card_Responds_To_ReadRecord_NotDDA_case_2
            solve( !KU( sign(<'04', ~PAN, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                              furtherData>,
                             ~privkBank)
                   ) @ #vk.52 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.61 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.85 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.102 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.102 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.104 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.103 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.84 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.39 )
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.68 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.66 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.68 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.66 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card
                    by contradiction /* from formulas */
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.98 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.59 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.83 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.97 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.99 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.98 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.82 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.38 )
                    case Card_Responds_To_GenerateAC_CDA_case_1
                    solve( !KU( ~UN ) @ #vk.69 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.68 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_GenerateAC_CDA_case_2
                    solve( !KU( ~UN ) @ #vk.69 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.68 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.65 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.65 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_3
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.65 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_4
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.65 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_5
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.65 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.64 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank_Card_ShK
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.64 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_CA
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.64 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card_case_1
                    by contradiction /* from formulas */
                  next
                    case Compromise_Card_case_2
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.64 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Generate_ATC
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.64 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_1
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.64 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_2
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.64 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case fresh
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkBank ) @ #vk.64 )
                        case Compromise_Bank
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                qed
              qed
            qed
          next
            case c_sign
            solve( !KU( sign(<'04', ~PAN, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                              furtherData>,
                             x.1)
                   ) @ #vk.52 )
              case Card_Responds_To_ReadRecord_NotDDA
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.60 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.84 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.96 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.96 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.98 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.97 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.83 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.39 )
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.84 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.67 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.84 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card
                    by contradiction /* from formulas */
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.92 )
                qed
              qed
            next
              case c_sign
              solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                              <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                     ) @ #vk.58 )
                case Card_Ext_Responds_To_Hello
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.81 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                    case Card_Ext_Responds_To_Hello
                    by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                  next
                    case Terminal_Ext_Sends_Hello
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                  next
                    case c_exp
                    by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                qed
              next
                case c_MAC
                solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.80 )
                  case Terminal_Ext_Sends_Hello
                  solve( !KU( ~PAN ) @ #vk.38 )
                    case Card_Responds_To_GenerateAC_CDA_case_1
                    solve( !KU( ~UN ) @ #vk.68 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.88 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_GenerateAC_CDA_case_2
                    solve( !KU( ~UN ) @ #vk.68 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.88 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_1
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.83 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_2
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.83 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_3
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.83 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_4
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.83 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Card_Responds_To_ReadRecord_NotDDA_case_5
                    solve( !KU( ~UN ) @ #vk.66 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA.1 ) @ #vk.83 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank
                    solve( !KU( ~UN ) @ #vk.64 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.81 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Bank_Card_ShK
                    solve( !KU( ~UN ) @ #vk.64 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.81 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_CA
                    solve( !KU( ~UN ) @ #vk.64 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.81 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Compromise_Card_case_1
                    by contradiction /* from formulas */
                  next
                    case Compromise_Card_case_2
                    solve( !KU( ~UN ) @ #vk.64 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.81 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Generate_ATC
                    solve( !KU( ~UN ) @ #vk.64 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.81 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_1
                    solve( !KU( ~UN ) @ #vk.64 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.81 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case Terminal_Sends_GPO_case_2
                    solve( !KU( ~UN ) @ #vk.64 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.81 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case fresh
                    solve( !KU( ~UN ) @ #vk.64 )
                      case Terminal_Sends_GPO
                      solve( !KU( ~privkCA ) @ #vk.81 )
                        case Compromise_CA
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.84 )
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  next
    case Terminal_Receives_AC_CDA_case_2
    by contradiction /* from formulas */
  next
    case Terminal_Receives_AC_CDA_case_3
    by contradiction /* from formulas */
  next
    case Terminal_Receives_AC_CDA_case_4
    solve( !KU( sign(<'05', nc, 'TC', AC, 
                      h(<
                         <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                          'TVR', 'ODCVM', 'HHMMSS'>, 
                         'TC', ATC, AC, IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>), 
                      ~UN>,
                     x.1)
           ) @ #vk.9 )
      case Card_Responds_To_GenerateAC_CDA
      solve( !KU( MAC(f(~MK, ~ATC),
                      <
                       <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                        'TVR', 'ODCVM', 'HHMMSS'>, 
                       <'CDA', $furtherData>, ~ATC, 'IAD', 'TC'>)
             ) @ #vk.8 )
        case Card_Responds_To_GenerateAC_CDA
        solve( !KU( sign(<'02', $Bank, pk(x), $CA>, ~privkCA) ) @ #vk.34 )
          case Card_Responds_To_ReadRecord_NotDDA_case_1
          solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                            'CDA', 'ODCVM', furtherData2>,
                           ~privkBank)
                 ) @ #vk.45 )
            case c_sign
            solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                              'MAC_CARD_TO_READER'),
                            <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                   ) @ #vk.56 )
              case Card_Ext_Responds_To_Hello
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.64 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                  case Card_Ext_Responds_To_Hello
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                next
                  case Terminal_Ext_Sends_Hello
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                next
                  case c_exp
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
              qed
            next
              case c_MAC
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.65 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                  case Card_Ext_Responds_To_Hello
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                next
                  case Terminal_Ext_Sends_Hello
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                next
                  case c_exp
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
              qed
            qed
          qed
        next
          case Card_Responds_To_ReadRecord_NotDDA_case_2
          solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                            'CDA', 'ODCVM', furtherData2>,
                           ~privkBank)
                 ) @ #vk.45 )
            case c_sign
            solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                              'MAC_CARD_TO_READER'),
                            <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                   ) @ #vk.56 )
              case Card_Ext_Responds_To_Hello
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.64 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                  case Card_Ext_Responds_To_Hello
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.86 )
                next
                  case Terminal_Ext_Sends_Hello
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.86 )
                next
                  case c_exp
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
              qed
            next
              case c_MAC
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.65 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                  case Card_Ext_Responds_To_Hello
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
                next
                  case Terminal_Ext_Sends_Hello
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.88 )
                next
                  case c_exp
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
              qed
            qed
          qed
        next
          case c_sign
          solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                            'CDA', 'ODCVM', furtherData2>,
                           x)
                 ) @ #vk.45 )
            case c_sign
            solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                              'MAC_CARD_TO_READER'),
                            <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                   ) @ #vk.55 )
              case Card_Ext_Responds_To_Hello
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.63 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                  case Card_Ext_Responds_To_Hello
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.80 )
                next
                  case Terminal_Ext_Sends_Hello
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.80 )
                next
                  case c_exp
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.82 )
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.81 )
              qed
            next
              case c_MAC
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.64 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                  case Card_Ext_Responds_To_Hello
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.82 )
                next
                  case Terminal_Ext_Sends_Hello
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.82 )
                next
                  case c_exp
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.84 )
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.83 )
              qed
            qed
          qed
        qed
      next
        case c_MAC
        solve( !KU( sign(<'02', $Bank, pk(x), $CA>, ~privkCA) ) @ #vk.35 )
          case Card_Responds_To_ReadRecord_NotDDA_case_1
          solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                            'CDA', 'ODCVM', furtherData2>,
                           ~privkBank)
                 ) @ #vk.48 )
            case c_sign
            solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                              'MAC_CARD_TO_READER'),
                            <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                   ) @ #vk.61 )
              case Card_Ext_Responds_To_Hello
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.69 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                  case Card_Ext_Responds_To_Hello
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                next
                  case Terminal_Ext_Sends_Hello
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                next
                  case c_exp
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
              qed
            next
              case c_MAC
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.70 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                  case Card_Ext_Responds_To_Hello
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                next
                  case Terminal_Ext_Sends_Hello
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                next
                  case c_exp
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.96 )
              qed
            qed
          qed
        next
          case Card_Responds_To_ReadRecord_NotDDA_case_2
          solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                            'CDA', 'ODCVM', furtherData2>,
                           ~privkBank)
                 ) @ #vk.48 )
            case c_sign
            solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                              'MAC_CARD_TO_READER'),
                            <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                   ) @ #vk.61 )
              case Card_Ext_Responds_To_Hello
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.69 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                  case Card_Ext_Responds_To_Hello
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.93 )
                next
                  case Terminal_Ext_Sends_Hello
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.93 )
                next
                  case c_exp
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
              qed
            next
              case c_MAC
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.70 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                  case Card_Ext_Responds_To_Hello
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.95 )
                next
                  case Terminal_Ext_Sends_Hello
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.95 )
                next
                  case c_exp
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.97 )
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.96 )
              qed
            qed
          qed
        next
          case c_sign
          solve( !KU( sign(<'04', ~PAN, pk(~privkCard), $Bank, 'OnlinePIN', 
                            'CDA', 'ODCVM', furtherData2>,
                           x)
                 ) @ #vk.48 )
            case c_sign
            solve( !KU( MAC(f('g'^(~Card_Eph_Sk*~Terminal_Eph_Sk),
                              'MAC_CARD_TO_READER'),
                            <'g'^~Card_Eph_Sk, 'g'^~Terminal_Eph_Sk>)
                   ) @ #vk.60 )
              case Card_Ext_Responds_To_Hello
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.68 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                  case Card_Ext_Responds_To_Hello
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.87 )
                next
                  case Terminal_Ext_Sends_Hello
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.87 )
                next
                  case c_exp
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.88 )
              qed
            next
              case c_MAC
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.69 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                  case Card_Ext_Responds_To_Hello
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.89 )
                next
                  case Terminal_Ext_Sends_Hello
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.89 )
                next
                  case c_exp
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.91 )
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
              qed
            qed
          qed
        qed
      qed
    next
      case c_sign
      solve( !KU( h(<
                     <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN>, 
                      'TVR', 'ODCVM', 'HHMMSS'>, 
                     'TC', ATC, AC, IAD, Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
             ) @ #vk.57 )
        case c_h
        solve( !KU( sign(<'02', $Bank, pk(x.1), $CA>, ~privkCA)
               ) @ #vk.41 )
          case Card_Responds_To_ReadRecord_NotDDA_case_1
          solve( !KU( sign(<'04', ~PAN, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                            'ODCVM', furtherData2>,
                           ~privkBank)
                 ) @ #vk.52 )
            case c_sign
            solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                            <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                   ) @ #vk.64 )
              case Card_Ext_Responds_To_Hello
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.83 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                  case Card_Ext_Responds_To_Hello
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.98 )
                next
                  case Terminal_Ext_Sends_Hello
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.98 )
                next
                  case c_exp
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.100 )
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.99 )
              qed
            next
              case c_MAC
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.82 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( ~PAN ) @ #vk.34 )
                  case Card_Responds_To_GenerateAC_CDA_case_1
                  solve( !KU( ~UN ) @ #vk.73 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.98 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_GenerateAC_CDA_case_2
                  solve( !KU( ~UN ) @ #vk.73 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.98 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_1
                  solve( !KU( ~UN ) @ #vk.71 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.94 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_2
                  solve( !KU( ~UN ) @ #vk.71 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.94 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_3
                  solve( !KU( ~UN ) @ #vk.71 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.93 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_4
                  solve( !KU( ~UN ) @ #vk.71 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.93 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_5
                  solve( !KU( ~UN ) @ #vk.71 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.93 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Compromise_Bank
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.91 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Compromise_Bank_Card_ShK
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.91 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Compromise_CA
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.91 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Compromise_Card_case_1
                  by contradiction /* from formulas */
                next
                  case Compromise_Card_case_2
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.91 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Generate_ATC
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.91 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Terminal_Sends_GPO_case_1
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.91 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Terminal_Sends_GPO_case_2
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.91 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case fresh
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.91 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
              qed
            qed
          qed
        next
          case Card_Responds_To_ReadRecord_NotDDA_case_2
          solve( !KU( sign(<'04', ~PAN, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                            'ODCVM', furtherData2>,
                           ~privkBank)
                 ) @ #vk.52 )
            case c_sign
            solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                            <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                   ) @ #vk.64 )
              case Card_Ext_Responds_To_Hello
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.83 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                  case Card_Ext_Responds_To_Hello
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.98 )
                next
                  case Terminal_Ext_Sends_Hello
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.98 )
                next
                  case c_exp
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.100 )
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.99 )
              qed
            next
              case c_MAC
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.82 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( ~PAN ) @ #vk.34 )
                  case Card_Responds_To_GenerateAC_CDA_case_1
                  solve( !KU( ~UN ) @ #vk.73 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.98 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_GenerateAC_CDA_case_2
                  solve( !KU( ~UN ) @ #vk.73 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.98 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_1
                  solve( !KU( ~UN ) @ #vk.71 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.93 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_2
                  solve( !KU( ~UN ) @ #vk.71 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.93 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_3
                  solve( !KU( ~UN ) @ #vk.71 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.93 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_4
                  solve( !KU( ~UN ) @ #vk.71 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.93 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_5
                  solve( !KU( ~UN ) @ #vk.71 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.93 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Compromise_Bank
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.91 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Compromise_Bank_Card_ShK
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.91 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Compromise_CA
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.91 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Compromise_Card_case_1
                  by contradiction /* from formulas */
                next
                  case Compromise_Card_case_2
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.91 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Generate_ATC
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.91 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Terminal_Sends_GPO_case_1
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.91 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Terminal_Sends_GPO_case_2
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.91 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case fresh
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkBank ) @ #vk.91 )
                      case Compromise_Bank
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.94 )
              qed
            qed
          qed
        next
          case c_sign
          solve( !KU( sign(<'04', ~PAN, pk(x), $Bank, 'OnlinePIN', 'CDA', 
                            'ODCVM', furtherData2>,
                           x.1)
                 ) @ #vk.52 )
            case c_sign
            solve( !KU( MAC(f(S, 'MAC_CARD_TO_READER'),
                            <Card_Eph_Pk, 'g'^~Terminal_Eph_Sk>)
                   ) @ #vk.63 )
              case Card_Ext_Responds_To_Hello
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.81 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( 'g'^(~Card_Eph_Sk*~Terminal_Eph_Sk) ) @ #j )
                  case Card_Ext_Responds_To_Hello
                  by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.90 )
                next
                  case Terminal_Ext_Sends_Hello
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.90 )
                next
                  case c_exp
                  by solve( !KU( ~Card_Eph_Sk ) @ #vk.92 )
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.91 )
              qed
            next
              case c_MAC
              solve( !KU( 'g'^~Terminal_Eph_Sk ) @ #vk.80 )
                case Terminal_Ext_Sends_Hello
                solve( !KU( ~PAN ) @ #vk.34 )
                  case Card_Responds_To_GenerateAC_CDA_case_1
                  solve( !KU( ~UN ) @ #vk.72 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkCA ) @ #vk.88 )
                      case Compromise_CA
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_GenerateAC_CDA_case_2
                  solve( !KU( ~UN ) @ #vk.72 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkCA ) @ #vk.88 )
                      case Compromise_CA
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_1
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkCA.1 ) @ #vk.83 )
                      case Compromise_CA
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_2
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkCA.1 ) @ #vk.83 )
                      case Compromise_CA
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_3
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkCA.1 ) @ #vk.83 )
                      case Compromise_CA
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_4
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkCA.1 ) @ #vk.83 )
                      case Compromise_CA
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Card_Responds_To_ReadRecord_NotDDA_case_5
                  solve( !KU( ~UN ) @ #vk.70 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkCA.1 ) @ #vk.83 )
                      case Compromise_CA
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Compromise_Bank
                  solve( !KU( ~UN ) @ #vk.68 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkCA ) @ #vk.81 )
                      case Compromise_CA
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Compromise_Bank_Card_ShK
                  solve( !KU( ~UN ) @ #vk.68 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkCA ) @ #vk.81 )
                      case Compromise_CA
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Compromise_CA
                  solve( !KU( ~UN ) @ #vk.68 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkCA ) @ #vk.81 )
                      case Compromise_CA
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Compromise_Card_case_1
                  by contradiction /* from formulas */
                next
                  case Compromise_Card_case_2
                  solve( !KU( ~UN ) @ #vk.68 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkCA ) @ #vk.81 )
                      case Compromise_CA
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Generate_ATC
                  solve( !KU( ~UN ) @ #vk.68 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkCA ) @ #vk.81 )
                      case Compromise_CA
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Terminal_Sends_GPO_case_1
                  solve( !KU( ~UN ) @ #vk.68 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkCA ) @ #vk.81 )
                      case Compromise_CA
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case Terminal_Sends_GPO_case_2
                  solve( !KU( ~UN ) @ #vk.68 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkCA ) @ #vk.81 )
                      case Compromise_CA
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case fresh
                  solve( !KU( ~UN ) @ #vk.68 )
                    case Terminal_Sends_GPO
                    solve( !KU( ~privkCA ) @ #vk.81 )
                      case Compromise_CA
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              next
                case c_exp
                by solve( !KU( ~Terminal_Eph_Sk ) @ #vk.85 )
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

/* All well-formedness checks were successful. */

end